 Log at 08/16/2020 8:13:06 AM
SqlContent: delete from DMVT where MaVT = @MaVT-ABC
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_dt22_dmvt". The conflict occurred in database "CBAKythuatBTHue", table "dbo.DT22", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 08/16/2020 8:14:16 AM
SqlContent: delete from DMVT where MaVT = @MaVT-ABC
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "FK_DT3A_DMVT20". The conflict occurred in database "CBAKythuatBTHue", table "dbo.DT3A", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 08/16/2020 8:14:32 AM
SqlContent: delete from DMVT where MaVT = @MaVT-ABC
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_vatout_mavt". The conflict occurred in database "CBAKythuatBTHue", table "dbo.VATOUT", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 08/16/2020 8:14:42 AM
SqlContent: delete from DMVT where MaVT = @MaVT-ABC
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_dt35_dmvt". The conflict occurred in database "CBAKythuatBTHue", table "dbo.DT35", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 08/16/2020 8:18:10 AM
SqlContent: select * from sysfield where  Type<>3 and sysTableid= order by TabIndex
Error code: 156
Message: Incorrect syntax near the keyword 'order'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 08/16/2020 8:19:10 AM
SqlContent: select * from sysfield where  Type<>3 and sysTableid= order by TabIndex
Error code: 156
Message: Incorrect syntax near the keyword 'order'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 08/16/2020 8:32:30 AM
SqlContent: 
DECLARE @NGAYCT1 DATETIME
SET @NGAYCT1='08/08/2020 00:00:00'
DECLARE @NGAYCT2 DATETIME
SET @NGAYCT2='08/31/2020 00:00:00'



SELECT B.MAVT,C.TENVT, C.MADVT,SUM(KLTRAM) AS SOLUONG
	INTO #T	FROM MT61 A
	INNER JOIN DT61 B ON A.MT61ID=B.MT61ID
	INNER JOIN DMVT C ON B.MAVT=C.MAVT
	WHERE  A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND (1 = 1)
	GROUP BY B.MAVT, C.MADVT, C.TENVT
	ORDER BY B.MAVT


SELECT A.MAVT AS MASP,A.TENVT AS TENSP,A.MADVT, B.MAVT, A.SOLUONG, A.SOLUONG*B.SOLUONG AS SLNVL
	INTO #T1 FROM #T A
	LEFT JOIN DFNVL B ON A.MAVT=B.MASP


SELECT A.MASP , A.TENSP, A.MADVT, A.MAVT,  D.TENVT,A.SOLUONG, A.SLNVL, 
	FROM #T1 A LEFT JOIN DMVT D ON A.MAVT=D.MAVT 

		ORDER BY MASP

DROP TABLE #T
DROP TABLE #T1
	
	
	
	
Error code: 156
Message: Incorrect syntax near the keyword 'FROM'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 08/16/2020 8:32:36 AM
SqlContent: 
DECLARE @NGAYCT1 DATETIME
SET @NGAYCT1='08/08/2020 00:00:00'
DECLARE @NGAYCT2 DATETIME
SET @NGAYCT2='08/31/2020 00:00:00'



SELECT B.MAVT,C.TENVT, C.MADVT,SUM(KLTRAM) AS SOLUONG
	INTO #T	FROM MT61 A
	INNER JOIN DT61 B ON A.MT61ID=B.MT61ID
	INNER JOIN DMVT C ON B.MAVT=C.MAVT
	WHERE  A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND (1 = 1)
	GROUP BY B.MAVT, C.MADVT, C.TENVT
	ORDER BY B.MAVT


SELECT A.MAVT AS MASP,A.TENVT AS TENSP,A.MADVT, B.MAVT, A.SOLUONG, A.SOLUONG*B.SOLUONG AS SLNVL
	INTO #T1 FROM #T A
	LEFT JOIN DFNVL B ON A.MAVT=B.MASP


SELECT A.MASP , A.TENSP, A.MADVT, A.MAVT,  D.TENVT,A.SOLUONG, A.SLNVL, 
	FROM #T1 A LEFT JOIN DMVT D ON A.MAVT=D.MAVT 

		ORDER BY MASP

DROP TABLE #T
DROP TABLE #T1
	
	
	
	
Error code: 156
Message: Incorrect syntax near the keyword 'FROM'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 08/21/2020 10:44:25 PM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-c12a0f14-366d-4c96-96b4-f924737366d0-CONGTY--False-0--08/05/2020 00:00:00-MH20080001-CONGTY-PNM--08/04/2020 00:00:00-3242-42--0--sfsf-VND-1.000000-3311-10-1331-11087-11087-1105-1109-12196-12192-0-False-0-0-01---0-0-1-7111-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD133", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 08/21/2020 11:41:12 PM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,GiamGia,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@GiamGia,@TaskID)-0-0--0-0-ef0087f9-4904-46cf-8f94-6ca3ce49891d-CONGTY--False-0--08/05/2020 00:00:00-MH20080001-CONGTY-PNM---345---0--dfsf-VND-1.000000-3311-10-1331-90000000-90000000-9000000-9000000-99000000-99000000-0-False-0-0-01---0-0-1-7111-False-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD200", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 10/08/2020 4:04:09 PM
SqlContent: DECLARE @TK NVARCHAR(16)
DECLARE @NGAYCT DATETIME
DECLARE @NGAYCT1 DATETIME
DECLARE @DK NVARCHAR(256)
DECLARE @SQL NVARCHAR (400)
DECLARE @MACN NVARCHAR(256)
SET @MACN='01'
IF(@MACN='00') SET @MACN = ''

SET @TK='131'
SET @NGAYCT='01/01/2020 00:00:00'
SET @NGAYCT1='12/31/2020 00:00:00'
--LẤY SỐ DƯ ĐẦU
SELECT * INTO  #WSODU FROM  ( SELECT MAKH,SUM(DUNO)AS DUNO, SUM(DUCO) AS DUCO FROM OBTK WHERE TK LIKE  @TK +'%' AND MACN LIKE @MACN +'%'  GROUP BY MAKH )X
SELECT * INTO  #WSOTK FROM  ( SELECT MAKH,SUM(PSNO)AS DUNO, SUM(PSCO) AS DUCO FROM BLTK WHERE TK LIKE  @TK +'%' AND NGAYCT<@NGAYCT AND  MACN LIKE @MACN +'%' GROUP BY MAKH) X
SELECT * INTO  #WG1	  FROM  ( SELECT * FROM #WSODU UNION SELECT * FROM #WSOTK) X

SELECT * INTO  #WDUDAU FROM ( SELECT MAKH,NODAU=CASE WHEN SUM(DUNO)-SUM(DUCO)>0 THEN SUM(DUNO)-SUM(DUCO) ELSE 0 END ,
					CODAU=CASE WHEN SUM(DUNO)-SUM(DUCO)<0 THEN SUM(DUCO)-SUM(DUNO) ELSE 0 END,0.0 AS PSNO, 0.0 AS PSCO, 0.0 AS NOCUOI, 0.0 AS COCUOI
					  FROM #WG1 GROUP BY MAKH)X

--LẤY SỐ PHÁT SINH

SELECT * INTO  #WSOPS FROM ( SELECT MAKH,0.0 AS NODAU,0.0 AS CODAU,SUM(PSNO)AS PSNO, SUM(PSCO) AS PSCO,0.0 AS NOCUOI, 0.0 AS COCUOI 
	FROM BLTK WHERE  TK LIKE  @TK +'%' AND  MACN LIKE @MACN +'%' AND NGAYCT BETWEEN @NGAYCT AND DATEADD(S,-1,DATEADD(D,1,@NGAYCT1))   GROUP BY MAKH)X


--LẤY SỐ DƯ CUỐI
SELECT * INTO  #WG2 FROM ( SELECT * FROM #WDUDAU UNION SELECT * FROM #WSOPS ) X


SELECT * INTO  #WKQ FROM ( 
	SELECT MAKH, SUM(NODAU) AS NODAU, SUM(CODAU) AS CODAU, SUM(PSNO) AS PSNO, SUM(PSCO) AS PSCO,
	NOCUOI=CASE WHEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)>0 THEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)ELSE 0 END,
	COCUOI=CASE WHEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)<0 THEN ABS(SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO))ELSE 0 END 
	FROM #WG2  GROUP BY MAKH 
	)X


IF @@NHOM1='' 
BEGIN
	SELECT B.NHOM1,A.*,B.TENKH FROM #WKQ A LEFT JOIN DMKH B ON  A.MAKH=B.MAKH WHERE NODAU<>0 OR CODAU<>0 OR PSNO <>0 OR PSCO<>0
END
ELSE
BEGIN 
	CREATE TABLE #TMPKH(MANHOMKH NVARCHAR(16) NULL)
	INSERT INTO #TMPKH (MANHOMKH) VALUES(@@NHOM1)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
	 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	SELECT B.NHOM1,A.*,B.TENKH FROM #WKQ A LEFT JOIN DMKH B ON  A.MAKH=B.MAKH WHERE  B.NHOM1 IN(SELECT MANHOMKH FROM #TMPKH) AND (NODAU<>0 OR CODAU<>0 OR PSNO <>0 OR PSCO<>0)
	DROP TABLE #TMPKH
END
DROP TABLE #WSODU
DROP TABLE #WSOTK
DROP TABLE #WG1
DROP TABLE #WDUDAU
DROP TABLE #WSOPS
DROP TABLE #WG2
DROP TABLE #WKQ

Error code: 137
Message: Must declare the scalar variable "@@NHOM1".
Incorrect syntax near the keyword 'ELSE'.
Must declare the scalar variable "@@NHOM1".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 10/08/2020 4:04:19 PM
SqlContent: DECLARE @TK NVARCHAR(16)
DECLARE @NGAYCT DATETIME
DECLARE @NGAYCT1 DATETIME
DECLARE @DK NVARCHAR(256)
DECLARE @SQL NVARCHAR (400)
DECLARE @MACN NVARCHAR(256)
SET @MACN='01'
IF(@MACN='00') SET @MACN = ''

SET @TK='131'
SET @NGAYCT='01/01/2020 00:00:00'
SET @NGAYCT1='12/31/2020 00:00:00'
--LẤY SỐ DƯ ĐẦU
SELECT * INTO  #WSODU FROM  ( SELECT MAKH,SUM(DUNO)AS DUNO, SUM(DUCO) AS DUCO FROM OBTK WHERE TK LIKE  @TK +'%' AND MACN LIKE @MACN +'%'  GROUP BY MAKH )X
SELECT * INTO  #WSOTK FROM  ( SELECT MAKH,SUM(PSNO)AS DUNO, SUM(PSCO) AS DUCO FROM BLTK WHERE TK LIKE  @TK +'%' AND NGAYCT<@NGAYCT AND  MACN LIKE @MACN +'%' GROUP BY MAKH) X
SELECT * INTO  #WG1	  FROM  ( SELECT * FROM #WSODU UNION SELECT * FROM #WSOTK) X

SELECT * INTO  #WDUDAU FROM ( SELECT MAKH,NODAU=CASE WHEN SUM(DUNO)-SUM(DUCO)>0 THEN SUM(DUNO)-SUM(DUCO) ELSE 0 END ,
					CODAU=CASE WHEN SUM(DUNO)-SUM(DUCO)<0 THEN SUM(DUCO)-SUM(DUNO) ELSE 0 END,0.0 AS PSNO, 0.0 AS PSCO, 0.0 AS NOCUOI, 0.0 AS COCUOI
					  FROM #WG1 GROUP BY MAKH)X

--LẤY SỐ PHÁT SINH

SELECT * INTO  #WSOPS FROM ( SELECT MAKH,0.0 AS NODAU,0.0 AS CODAU,SUM(PSNO)AS PSNO, SUM(PSCO) AS PSCO,0.0 AS NOCUOI, 0.0 AS COCUOI 
	FROM BLTK WHERE  TK LIKE  @TK +'%' AND  MACN LIKE @MACN +'%' AND NGAYCT BETWEEN @NGAYCT AND DATEADD(S,-1,DATEADD(D,1,@NGAYCT1))   GROUP BY MAKH)X


--LẤY SỐ DƯ CUỐI
SELECT * INTO  #WG2 FROM ( SELECT * FROM #WDUDAU UNION SELECT * FROM #WSOPS ) X


SELECT * INTO  #WKQ FROM ( 
	SELECT MAKH, SUM(NODAU) AS NODAU, SUM(CODAU) AS CODAU, SUM(PSNO) AS PSNO, SUM(PSCO) AS PSCO,
	NOCUOI=CASE WHEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)>0 THEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)ELSE 0 END,
	COCUOI=CASE WHEN SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO)<0 THEN ABS(SUM(NODAU)+SUM(PSNO)-SUM(CODAU)-SUM(PSCO))ELSE 0 END 
	FROM #WG2  GROUP BY MAKH 
	)X


IF @@NHOM1='' 
BEGIN
	SELECT B.NHOM1,A.*,B.TENKH FROM #WKQ A LEFT JOIN DMKH B ON  A.MAKH=B.MAKH WHERE NODAU<>0 OR CODAU<>0 OR PSNO <>0 OR PSCO<>0
END
ELSE
BEGIN 
	CREATE TABLE #TMPKH(MANHOMKH NVARCHAR(16) NULL)
	INSERT INTO #TMPKH (MANHOMKH) VALUES(@@NHOM1)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
	 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	INSERT INTO #TMPKH (MANHOMKH) SELECT MANHOMKH FROM DMNHOMKH WHERE
		 MANHOMKHME IN (SELECT MANHOMKH FROM #TMPKH) AND MANHOMKH NOT IN (SELECT MANHOMKH FROM #TMPKH)
	SELECT B.NHOM1,A.*,B.TENKH FROM #WKQ A LEFT JOIN DMKH B ON  A.MAKH=B.MAKH WHERE  B.NHOM1 IN(SELECT MANHOMKH FROM #TMPKH) AND (NODAU<>0 OR CODAU<>0 OR PSNO <>0 OR PSCO<>0)
	DROP TABLE #TMPKH
END
DROP TABLE #WSODU
DROP TABLE #WSOTK
DROP TABLE #WG1
DROP TABLE #WDUDAU
DROP TABLE #WSOPS
DROP TABLE #WG2
DROP TABLE #WKQ

Error code: 137
Message: Must declare the scalar variable "@@NHOM1".
Incorrect syntax near the keyword 'ELSE'.
Must declare the scalar variable "@@NHOM1".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 10/10/2020 9:38:46 AM
SqlContent: SELECT B.MAVT, C.TENVT,B.MADVT, SUM(SOLUONG) AS SL, SUM(PS) AS DT FROM MT3A A INNER JOIN DT3A B ON A.MT3AID=B.MT3AID INNER JOIN DMVT C ON B.MAVT=C.MAVT WHERE A.NGAYCT BETWEEN '01/01/2020 00:00:00' AND '12/31/2020 00:00:00' AND 1 = 1 and MaCN = '01'
Error code: 8120
Message: Column 'DT3A.MaVT' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 10/10/2020 10:07:44 AM
SqlContent: select MaCN as colField from MT3A where 1 = 1 and b.MaKho like 'HCM%' group by MaCN
Error code: 4104
Message: The multi-part identifier "b.MaKho" could not be bound.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
BIANGMV-001
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='BIANGMV-001' and (MaKH='HCM11-008' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
Giá vt BIANGMV-001:240000.000000
-------------------------------
GXMKR400-001
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='GXMKR400-001' and (MaKH='HCM09-001' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
AA
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='AA' and (MaKH='0100111948021' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
 Log at 10/12/2020 4:42:34 PM
SqlContent: insert into MT35(MT35ID,MaCT,OngBa,TtienH,TCKNT,TCK,Tthue,Ttien,Approved,sysDBID,MaCN,TGiaCL,TSlConlai,SDT,DCGiaoHang,NgayCT,SoCT,TaskID,MaKH,Kho,HDTheoHang,LayHD,DaDPXe,isDaGiao,IsGiaoGiup,TtienNT,MaNT,MaNVien,HanNo,NgayGDK,TSoluong,DienGiai,MaThue,TDagiao,TyGia,TthueNT,TtienHNT,Congno,MucNo,Duyet,TLenXe,MaDD,DiaChi,HangGC,KhoXN) values(@MT35ID,@MaCT,@OngBa,@TtienH,@TCKNT,@TCK,@Tthue,@Ttien,@Approved,@sysDBID,@MaCN,@TGiaCL,@TSlConlai,@SDT,@DCGiaoHang,@NgayCT,@SoCT,@TaskID,@MaKH,@Kho,@HDTheoHang,@LayHD,@DaDPXe,@isDaGiao,@IsGiaoGiup,@TtienNT,@MaNT,@MaNVien,@HanNo,@NgayGDK,@TSoluong,@DienGiai,@MaThue,@TDagiao,@TyGia,@TthueNT,@TtienHNT,@Congno,@MucNo,@Duyet,@TLenXe,@MaDD,@DiaChi,@HangGC,@KhoXN)-c480cb5c-af97-4eae-9519-8142fe68177a-DHB-NH TMCP Công Thương VN - CN TT Huế-25000-0-0-0-25000-0--01-25000-1---10/12/2020 00:00:00-DH20100001-e15f14ea-0abd-4045-ab81-d3881016c69f-0100111948021-HH-False-False-False-False-False-25000-VND-AB-1-10/13/2020 00:00:00-1-dsfsdf-00-0-1.000000-0-25000-0-0.000000-False-0--Số 02 Lê Quý Đôn, P. Phú Hội, TP Huế, tỉnh TT-Huế-False-False
Error code: 515
Message: Cannot insert the value NULL into column 'SDT', table 'CBASGD200.dbo.MT35'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
AA
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='AA' and (MaKH='0100283873019' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
 Log at 10/12/2020 4:45:23 PM
SqlContent: insert into MT35(MT35ID,MaCT,OngBa,TtienH,TCKNT,TCK,Tthue,Ttien,Approved,sysDBID,MaCN,TGiaCL,TSlConlai,SDT,DCGiaoHang,NgayCT,SoCT,TaskID,MaKH,Kho,HDTheoHang,LayHD,DaDPXe,isDaGiao,IsGiaoGiup,TtienNT,MaNT,MaNVien,HanNo,NgayGDK,TSoluong,DienGiai,MaThue,TDagiao,TyGia,TthueNT,TtienHNT,Congno,MucNo,Duyet,TLenXe,MaDD,DiaChi,HangGC,KhoXN) values(@MT35ID,@MaCT,@OngBa,@TtienH,@TCKNT,@TCK,@Tthue,@Ttien,@Approved,@sysDBID,@MaCN,@TGiaCL,@TSlConlai,@SDT,@DCGiaoHang,@NgayCT,@SoCT,@TaskID,@MaKH,@Kho,@HDTheoHang,@LayHD,@DaDPXe,@isDaGiao,@IsGiaoGiup,@TtienNT,@MaNT,@MaNVien,@HanNo,@NgayGDK,@TSoluong,@DienGiai,@MaThue,@TDagiao,@TyGia,@TthueNT,@TtienHNT,@Congno,@MucNo,@Duyet,@TLenXe,@MaDD,@DiaChi,@HangGC,@KhoXN)-ef635c1a-3cf5-4005-bb97-84ed5b2e261f-DHB-Ngân Hàng Thương Mại Cổ Phần Quân Đội-CN TT Huế-2500-0-0-0-2500-0--01-2500-1---10/12/2020 00:00:00-DH20100001-e15f14ea-0abd-4045-ab81-d3881016c69f-0100283873019-HH-False-False-False-False-False-2500-VND-AB-1-10/13/2020 00:00:00-1-r242-00-0-1.000000-0-2500-0-0.000000-False-0--Số 21 Cát Linh - Quận Đống đa - Hà Nội-False-False
Error code: 515
Message: Cannot insert the value NULL into column 'SDT', table 'CBASGD200.dbo.MT35'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
AA
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='AA' and (MaKH='0100110091' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
BIATHTR-258
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='BIATHTR-258' and (MaKH='HCM05-004' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
Giá vt BIATHTR-258:29000.000000
-------------------------------
BIATHMV-022
-------------------------------
Câu lệnh sql:Select * from wGiaBan where (NgayEX is null or NgayEX>'10/12/2020 00:00:00') and MaVT='BIATHMV-022' and (MaKH='HCM05-004' or MaKH is null) order by MaKH desc, NgayCT desc
-------------------------------
Giá vt BIATHMV-022:26000.000000
-------------------------------
 Log at 11/04/2020 9:17:20 AM
SqlContent: select * from wMT32 where status <1 or status is null
Error code: 207
Message: Invalid column name 'status'.
Invalid column name 'status'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/04/2020 10:02:51 AM
SqlContent: delete from BLTK where MTID = '2bf22d3d-9d28-4fd8-862b-9ea52931b1ec' and NhomDk = 'HDB1'
Error code: 1205
Message: Transaction (Process ID 102) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/05/2020 5:54:27 PM
SqlContent: update mt32 set status=2 where IDHDDT='7d32e55b-b327-4f22-8565-ed916065eaa6'
Error code: 207
Message: Invalid column name 'IDHDDT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/05/2020 5:54:29 PM
SqlContent: update mt31 set status=2 where IDHDDT='7d32e55b-b327-4f22-8565-ed916065eaa6'
Error code: 207
Message: Invalid column name 'IDHDDT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/05/2020 5:57:54 PM
SqlContent: update mt32 set status=2 where IDHDDT='9551e48a-1d1b-44a3-beb3-6455fa146c12'
Error code: 207
Message: Invalid column name 'IDHDDT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/05/2020 5:57:54 PM
SqlContent: update mt31 set status=2 where IDHDDT='9551e48a-1d1b-44a3-beb3-6455fa146c12'
Error code: 207
Message: Invalid column name 'IDHDDT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/05/2020 5:58:40 PM
SqlContent: update mt32 set status=2 where IDHDDT='9551e48a-1d1b-44a3-beb3-6455fa146c12'
Error code: 207
Message: Invalid column name 'IDHDDT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
Cannot find either column "CDTBPM05_VTAK" or the user-defined function or aggregate "CDTBPM05_VTAK.dbo.GetBTid", or the name is ambiguous.
-------------------------------
Cannot find either column "CDTBPM05_VTAK" or the user-defined function or aggregate "CDTBPM05_VTAK.dbo.GetBTid", or the name is ambiguous.
-------------------------------
Cannot find either column "CDTBPM05_VTAK" or the user-defined function or aggregate "CDTBPM05_VTAK.dbo.GetBTid", or the name is ambiguous.
-------------------------------
Cannot find either column "CDTBPM05_VTAK" or the user-defined function or aggregate "CDTBPM05_VTAK.dbo.GetBTid", or the name is ambiguous.
-------------------------------
 Log at 11/11/2020 11:49:45 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN SoGTGC
Error code: 5074
Message: The object 'DF_DMNVien_So_GTGC' is dependent on column 'SoGTGC'.
ALTER TABLE DROP COLUMN SoGTGC failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:47 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN LuongCB
Error code: 5074
Message: The object 'DF_DMNVien_Luong_CB' is dependent on column 'LuongCB'.
ALTER TABLE DROP COLUMN LuongCB failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:48 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN LuongKhoan
Error code: 5074
Message: The object 'DF_DMNVien_Luong_Khoan' is dependent on column 'LuongKhoan'.
ALTER TABLE DROP COLUMN LuongKhoan failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:49 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN PCCVu
Error code: 5074
Message: The object 'DF_DMNVien_PC_CVu' is dependent on column 'PCCVu'.
ALTER TABLE DROP COLUMN PCCVu failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:50 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN PCDThoai
Error code: 5074
Message: The object 'DF_DMNVien_PC_DThoai' is dependent on column 'PCDThoai'.
ALTER TABLE DROP COLUMN PCDThoai failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:50 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN PCCom
Error code: 5074
Message: The object 'DF_DMNVien_PC_Com' is dependent on column 'PCCom'.
ALTER TABLE DROP COLUMN PCCom failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:51 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN PCXang
Error code: 5074
Message: The object 'DF_DMNVien_PC_Xang' is dependent on column 'PCXang'.
ALTER TABLE DROP COLUMN PCXang failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:51 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN LuongTThieu
Error code: 5074
Message: The object 'DF_DMNVien_Luong_TThieu' is dependent on column 'LuongTThieu'.
ALTER TABLE DROP COLUMN LuongTThieu failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 11:49:52 AM
SqlContent: ALTER TABLE DMNVien DROP COLUMN HTTLuong
Error code: 5074
Message: The object 'DF_DMNVien_HT_TLuong' is dependent on column 'HTTLuong'.
ALTER TABLE DROP COLUMN HTTLuong failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/11/2020 3:39:18 PM
SqlContent: DECLARE @NGAYCT1  DATETIME 
 DECLARE @NGAYCT2 DATETIME 
  DECLARE @NGAYDAUNAM DATETIME 
   SET  @NGAYCT1=  '01/01/2020 00:00:00'--'01/01/2015'--
   SET  @NGAYCT2=    '02/12/2020 00:00:00'--'12/31/2015'--
   DECLARE @MACONGTRINH NVARCHAR(32)
   SET @MACONGTRINH=@@MACONGTRINH
   SELECT MACONGTRINH INTO #DMCONGTRINH FROM DMCONGTRINH WHERE 1=0
   IF(@MACONGTRINH='')
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH
END
ELSE
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH=@MACONGTRINH
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)

END

   SET @NGAYDAUNAM= CONVERT(DATETIME,'01/01'+'/'+ CONVERT(NVARCHAR(4), YEAR(@NGAYCT1)))  
   CREATE  TABLE #TAM   (   [MACONGTRINH] [NVARCHAR]  (50) NULL ,
       [DD]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,
          [GIATHANHTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,    
          [GIATHANHLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [GIATHANHLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0  ) ON [PRIMARY]   
--DỞ DANG ĐẦU KỲ  
INSERT INTO #TAM (MACONGTRINH, DD)   
SELECT MACONGTRINH, DD FROM  (
   SELECT MACONGTRINH, SUM(TIEN) AS DD FROM   (
        SELECT MACONGTRINH,SUM(DUNO) AS TIEN FROM OBTK WHERE TK LIKE '154%' GROUP BY MACONGTRINH     
        UNION ALL     
        SELECT MACONGTRINH,SUM(PSNO-PSCO)AS TIEN FROM BLTK WHERE  TK='154' AND NGAYCT<@NGAYCT1 GROUP BY MACONGTRINH   
        )X GROUP BY MACONGTRINH  )Y WHERE MACONGTRINH IS NOT NULL   
--PHÁT SINH TRONG KỲ  
INSERT INTO #TAM (MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,LAILOTK)   
SELECT MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,-GIATHANHTK-CPQLTK+ DTTK FROM  (
   SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHTK, 0.0 AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL 
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK, SUM(PSCO) AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK,0.0 AS CPQLTK, SUM(PSNO) AS DTTK 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH  
   )X  
INSERT INTO #TAM (MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,LAILOLKDN)   
SELECT MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,-GIATHANHLKDN-CPQLLKDN+ DTLKDN FROM  (
  -- LŨY KẾ TỪ ĐẦU NĂM   
  SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKDN, 0.0 AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN, SUM(PSCO) AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN,0.0 AS CPQLLKDN, SUM(PSNO) AS DTLKDN 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
  )X  
  -- LŨY KẾ TỪ KHI KHỞI CÔNG  
  INSERT INTO #TAM (MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,LAILOLKKC)   
  SELECT MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,-GIATHANHLKKC-CPQLLKKC+ DTLKKC FROM  (
     SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKKC, 0.0 AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC, SUM(PSCO) AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC,0.0 AS CPQLLKKC, SUM(PSNO) AS DTLKKC 
		FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
     )X    
 SELECT B.MACONGTRINHME,X.*,B.TENCONGTRINH FROM  (
    SELECT MACONGTRINH, SUM(DD) AS DD, SUM(GIATHANHTK) AS GIATHANHTK, SUM(CPQLTK) AS CPQLTK, SUM(DTTK) AS DTTK, SUM(LAILOTK) AS LAILOTK,
         SUM(GIATHANHLKDN+CPQLLKDN) AS TCPKDN, SUM(DTLKDN) AS DTLKDN, SUM(LAILOLKDN) AS LAILOLKDN,
         SUM(GIATHANHLKKC+CPQLLKKC) AS TCPLKKC, SUM(DTLKKC) AS DTLKKC, SUM(LAILOLKKC) AS LAILOLKKC
         FROM #TAM GROUP BY MACONGTRINH  
     )X INNER JOIN DMCONGTRINH B ON X.MACONGTRINH=B.MACONGTRINH 
		WHERE (TCPLKKC<>0 OR DTLKKC<>0 OR LAILOLKKC<>0) AND B.MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
UNION ALL
SELECT '', N'ZTỔNG CỘNG', SUM(DD), SUM([GIATHANHTK]),SUM([CPQLTK]),   SUM([DTTK]),   SUM([LAILOTK]),
	SUM(GIATHANHLKDN+CPQLLKDN),  SUM([DTLKDN] ),SUM([LAILOLKDN]), SUM(GIATHANHLKKC+CPQLLKKC),   SUM([DTLKKC]),SUM([LAILOLKKC]),N'ZTỔNG CỘNG'
FROM #TAM WHERE  MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	DROP TABLE #DMCONGTRINH
     DROP TABLE #TAM  
Error code: 137
Message: Must declare the scalar variable "@@MACONGTRINH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 11/11/2020 3:47:40 PM
SqlContent: DECLARE @NGAYCT1  DATETIME 
 DECLARE @NGAYCT2 DATETIME 
  DECLARE @NGAYDAUNAM DATETIME 
   SET  @NGAYCT1=  '01/01/2020 00:00:00'--'01/01/2015'--
   SET  @NGAYCT2=    '02/12/2020 00:00:00'--'12/31/2015'--
   DECLARE @MACONGTRINH NVARCHAR(32)
   SET @MACONGTRINH=@@MACONGTRINH
   SELECT MACONGTRINH INTO #DMCONGTRINH FROM DMCONGTRINH WHERE 1=0
   IF(@MACONGTRINH='')
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH
END
ELSE
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH=@MACONGTRINH
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)

END

   SET @NGAYDAUNAM= CONVERT(DATETIME,'01/01'+'/'+ CONVERT(NVARCHAR(4), YEAR(@NGAYCT1)))  
   CREATE  TABLE #TAM   (   [MACONGTRINH] [NVARCHAR]  (50) NULL ,
       [DD]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,
          [GIATHANHTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,    
          [GIATHANHLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [GIATHANHLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0  ) ON [PRIMARY]   
--DỞ DANG ĐẦU KỲ  
INSERT INTO #TAM (MACONGTRINH, DD)   
SELECT MACONGTRINH, DD FROM  (
   SELECT MACONGTRINH, SUM(TIEN) AS DD FROM   (
        SELECT MACONGTRINH,SUM(DUNO) AS TIEN FROM OBTK WHERE TK LIKE '154%' GROUP BY MACONGTRINH     
        UNION ALL     
        SELECT MACONGTRINH,SUM(PSNO-PSCO)AS TIEN FROM BLTK WHERE  TK='154' AND NGAYCT<@NGAYCT1 GROUP BY MACONGTRINH   
        )X GROUP BY MACONGTRINH  )Y WHERE MACONGTRINH IS NOT NULL   
--PHÁT SINH TRONG KỲ  
INSERT INTO #TAM (MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,LAILOTK)   
SELECT MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,-GIATHANHTK-CPQLTK+ DTTK FROM  (
   SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHTK, 0.0 AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL 
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK, SUM(PSCO) AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK,0.0 AS CPQLTK, SUM(PSNO) AS DTTK 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH  
   )X  
INSERT INTO #TAM (MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,LAILOLKDN)   
SELECT MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,-GIATHANHLKDN-CPQLLKDN+ DTLKDN FROM  (
  -- LŨY KẾ TỪ ĐẦU NĂM   
  SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKDN, 0.0 AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN, SUM(PSCO) AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN,0.0 AS CPQLLKDN, SUM(PSNO) AS DTLKDN 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
  )X  
  -- LŨY KẾ TỪ KHI KHỞI CÔNG  
  INSERT INTO #TAM (MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,LAILOLKKC)   
  SELECT MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,-GIATHANHLKKC-CPQLLKKC+ DTLKKC FROM  (
     SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKKC, 0.0 AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC, SUM(PSCO) AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC,0.0 AS CPQLLKKC, SUM(PSNO) AS DTLKKC 
		FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
     )X    
 SELECT B.MACONGTRINHME,X.*,B.TENCONGTRINH FROM  (
    SELECT MACONGTRINH, SUM(DD) AS DD, SUM(GIATHANHTK) AS GIATHANHTK, SUM(CPQLTK) AS CPQLTK, SUM(DTTK) AS DTTK, SUM(LAILOTK) AS LAILOTK,
         SUM(GIATHANHLKDN+CPQLLKDN) AS TCPKDN, SUM(DTLKDN) AS DTLKDN, SUM(LAILOLKDN) AS LAILOLKDN,
         SUM(GIATHANHLKKC+CPQLLKKC) AS TCPLKKC, SUM(DTLKKC) AS DTLKKC, SUM(LAILOLKKC) AS LAILOLKKC
         FROM #TAM GROUP BY MACONGTRINH  
     )X INNER JOIN DMCONGTRINH B ON X.MACONGTRINH=B.MACONGTRINH 
		WHERE (TCPLKKC<>0 OR DTLKKC<>0 OR LAILOLKKC<>0) AND B.MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
UNION ALL
SELECT '', N'ZTỔNG CỘNG', SUM(DD), SUM([GIATHANHTK]),SUM([CPQLTK]),   SUM([DTTK]),   SUM([LAILOTK]),
	SUM(GIATHANHLKDN+CPQLLKDN),  SUM([DTLKDN] ),SUM([LAILOLKDN]), SUM(GIATHANHLKKC+CPQLLKKC),   SUM([DTLKKC]),SUM([LAILOLKKC]),N'ZTỔNG CỘNG'
FROM #TAM WHERE  MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	DROP TABLE #DMCONGTRINH
     DROP TABLE #TAM  
Error code: 137
Message: Must declare the scalar variable "@@MACONGTRINH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 11/11/2020 3:48:19 PM
SqlContent: DECLARE @NGAYCT1  DATETIME 
 DECLARE @NGAYCT2 DATETIME 
  DECLARE @NGAYDAUNAM DATETIME 
   SET  @NGAYCT1=  '01/01/2020 00:00:00'--'01/01/2015'--
   SET  @NGAYCT2=    '02/12/2020 00:00:00'--'12/31/2015'--
   DECLARE @MACONGTRINH NVARCHAR(32)
   SET @MACONGTRINH=@@MACONGTRINH
   SELECT MACONGTRINH INTO #DMCONGTRINH FROM DMCONGTRINH WHERE 1=0
   IF(@MACONGTRINH='')
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH
END
ELSE
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH=@MACONGTRINH
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)

END

   SET @NGAYDAUNAM= CONVERT(DATETIME,'01/01'+'/'+ CONVERT(NVARCHAR(4), YEAR(@NGAYCT1)))  
   CREATE  TABLE #TAM   (   [MACONGTRINH] [NVARCHAR]  (50) NULL ,
       [DD]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,
          [GIATHANHTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,    
          [GIATHANHLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [GIATHANHLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0  ) ON [PRIMARY]   
--DỞ DANG ĐẦU KỲ  
INSERT INTO #TAM (MACONGTRINH, DD)   
SELECT MACONGTRINH, DD FROM  (
   SELECT MACONGTRINH, SUM(TIEN) AS DD FROM   (
        SELECT MACONGTRINH,SUM(DUNO) AS TIEN FROM OBTK WHERE TK LIKE '154%' GROUP BY MACONGTRINH     
        UNION ALL     
        SELECT MACONGTRINH,SUM(PSNO-PSCO)AS TIEN FROM BLTK WHERE  TK='154' AND NGAYCT<@NGAYCT1 GROUP BY MACONGTRINH   
        )X GROUP BY MACONGTRINH  )Y WHERE MACONGTRINH IS NOT NULL   
--PHÁT SINH TRONG KỲ  
INSERT INTO #TAM (MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,LAILOTK)   
SELECT MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,-GIATHANHTK-CPQLTK+ DTTK FROM  (
   SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHTK, 0.0 AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL 
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK, SUM(PSCO) AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK,0.0 AS CPQLTK, SUM(PSNO) AS DTTK 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH  
   )X  
INSERT INTO #TAM (MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,LAILOLKDN)   
SELECT MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,-GIATHANHLKDN-CPQLLKDN+ DTLKDN FROM  (
  -- LŨY KẾ TỪ ĐẦU NĂM   
  SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKDN, 0.0 AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN, SUM(PSCO) AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN,0.0 AS CPQLLKDN, SUM(PSNO) AS DTLKDN 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
  )X  
  -- LŨY KẾ TỪ KHI KHỞI CÔNG  
  INSERT INTO #TAM (MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,LAILOLKKC)   
  SELECT MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,-GIATHANHLKKC-CPQLLKKC+ DTLKKC FROM  (
     SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKKC, 0.0 AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC, SUM(PSCO) AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC,0.0 AS CPQLLKKC, SUM(PSNO) AS DTLKKC 
		FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
     )X    
 SELECT B.MACONGTRINHME,X.*,B.TENCONGTRINH FROM  (
    SELECT MACONGTRINH, SUM(DD) AS DD, SUM(GIATHANHTK) AS GIATHANHTK, SUM(CPQLTK) AS CPQLTK, SUM(DTTK) AS DTTK, SUM(LAILOTK) AS LAILOTK,
         SUM(GIATHANHLKDN+CPQLLKDN) AS TCPKDN, SUM(DTLKDN) AS DTLKDN, SUM(LAILOLKDN) AS LAILOLKDN,
         SUM(GIATHANHLKKC+CPQLLKKC) AS TCPLKKC, SUM(DTLKKC) AS DTLKKC, SUM(LAILOLKKC) AS LAILOLKKC
         FROM #TAM GROUP BY MACONGTRINH  
     )X INNER JOIN DMCONGTRINH B ON X.MACONGTRINH=B.MACONGTRINH 
		WHERE (TCPLKKC<>0 OR DTLKKC<>0 OR LAILOLKKC<>0) AND B.MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
UNION ALL
SELECT '', N'ZTỔNG CỘNG', SUM(DD), SUM([GIATHANHTK]),SUM([CPQLTK]),   SUM([DTTK]),   SUM([LAILOTK]),
	SUM(GIATHANHLKDN+CPQLLKDN),  SUM([DTLKDN] ),SUM([LAILOLKDN]), SUM(GIATHANHLKKC+CPQLLKKC),   SUM([DTLKKC]),SUM([LAILOLKKC]),N'ZTỔNG CỘNG'
FROM #TAM WHERE  MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	DROP TABLE #DMCONGTRINH
     DROP TABLE #TAM  
Error code: 137
Message: Must declare the scalar variable "@@MACONGTRINH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 11/12/2020 3:15:49 PM
SqlContent: select MaNVien, TenNVien, Macvu,Mabophan from dmnvien where Thoiviec=0
Error code: 207
Message: Invalid column name 'Mabophan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/12/2020 3:21:31 PM
SqlContent: select MaNVien, TenNVien, Macvu,Mabophan from dmnvien where Thoiviec=0
Error code: 207
Message: Invalid column name 'Mabophan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/14/2020 10:22:47 AM
SqlContent:  update BLTK set PsNo = DT33.TienVon ,PsNoNT = DT33.TienVon  from BLTK,MT33,DT33 where BLTK.MTID = MT33.MT33ID and BLTK.MTIDDT = DT33.DT33ID and BLTK.nhomdk = 'HTL3' and (MT33.ngayct between cast('05/01/2019' as datetime) and cast('05/31/2019' as datetime))
Error code: 1205
Message: Transaction (Process ID 99) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/14/2020 10:22:50 AM
SqlContent:  update BLTK set PsCo = DT33.TienVon ,PsCoNT = DT33.TienVon  from BLTK,MT33,DT33 where BLTK.MTID = MT33.MT33ID and BLTK.MTIDDT = DT33.DT33ID and BLTK.nhomdk = 'HTL4' and (MT33.ngayct between cast('05/01/2019' as datetime) and cast('05/31/2019' as datetime))
Error code: 1205
Message: Transaction (Process ID 99) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/14/2020 10:23:04 AM
SqlContent:  update BLVT set PsNo = DT33.TienVon ,PsNoNT = DT33.TienVon ,DonGia = DT33.GiaVon ,DonGiaNT = DT33.GiaVon  from BLVT,MT33,DT33 where BLVT.MTID = MT33.MT33ID and BLVT.MTIDDT = DT33.DT33ID and BLVT.nhomdk = 'HTL1' and (MT33.ngayct between cast('05/01/2019' as datetime) and cast('05/31/2019' as datetime))
Error code: 1205
Message: Transaction (Process ID 99) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:35:40 PM
SqlContent: update ctYTL set LuongNgay = b.LuongNgay from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and MaNVien in ((select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 102
Message: Incorrect syntax near ')'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:38:05 PM
SqlContent: update ctytl set NgayCong = b.kq from ctYTL a inner join (select MaNVien,sum(SoNC) as kq,2020 as nam, 11 as thang from DTCC where nam=2020 and  thang= 11 group by MaNVien) b on a.MaNVien=b.MaNVien where a.MaNVien in ((select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 102
Message: Incorrect syntax near ')'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:41:24 PM
SqlContent: update ctbangluong set LNgayCong= b.LuongNgay*b.NgayCong from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'manvien'.
Invalid column name 'MaNVien'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:56 PM
SqlContent: update ctbangluong set LPCDT= b.PCDThoai from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCDThoai'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:58 PM
SqlContent: update ctbangluong set LPCXang= b.PCXang from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCXang'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHXH0= ROUND(b.LuongBH*b.BHXH0/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHXH0'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHYT0= ROUND(b.LuongBH*b.BHYT0/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHYT0'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHTN0= ROUND(b.LuongBH*b.BHTN0/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHTN0'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHXH1= ROUND(b.LuongBH*b.BHXH1/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHXH1'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHYT1= ROUND(b.LuongBH*b.BHYT1/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHYT1'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctbangluong set LBHTN1= ROUND(b.LuongBH*b.BHTN1/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'BHTN1'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:46:59 PM
SqlContent: update ctYTL set GTBT = b.GTBThan from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'GTBThan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:49:15 PM
SqlContent: update ctbangluong set LPCDT= b.PCDThoai from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCDThoai'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 4:49:15 PM
SqlContent: update ctbangluong set LPCXang= b.PCXang from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCXang'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:04:01 PM
SqlContent: update ctbangluong set LPCDT= b.PCDThoai from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCDThoai'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:04:01 PM
SqlContent: update ctbangluong set LPCXang= b.PCXang from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'PCXang'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:09:18 PM
SqlContent: update ctYTL set GTBT = b.GTBThan from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'GTBThan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:14:38 PM
SqlContent: update ctYTL set GTBT = b.GTBThan from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'GTBThan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:15:50 PM
SqlContent: update ctYTL set GTBT = b.GTBThan from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'GTBThan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:16:01 PM
SqlContent: update ctbangluong set LThucNhan=LNgayCong + LTC + LPCCom + LPCCVu + LPCDHai +LPCDThoai + LPCNha +LPCXang where  nam = 2020 and thang = 11 and manvien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'LPCDThoai'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:19:25 PM
SqlContent: update ctbangluong set LThucNhan=LNgayCong + LTC + LPCCom + LPCCVu + LPCDHai +LPCDThoai + LPCNha +LPCXang where  nam = 2020 and thang = 11 and manvien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'LPCDThoai'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:22:57 PM
SqlContent: update ctYTL set GTBT = b.GTBThan from ctYTL a inner join  QTTLuong b on a.MaNVien=b.MaNVien where a.nam=2020 and  a.thang= 11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'GTBThan'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:26:58 PM
SqlContent: select a.MaNVien, LNGAYCONG, LTC, LPCCOM, LPCCVU, LPCDHAI, LBHXH0, LBHYT0, LBHTN0,LBHXH1, LBHYT1, LBHTN1,LThucNhan, LGTBT, LGTGC, TNCThue, ThucLinh from ctbangluong a inner join dmnvien b on a.manvien=b.manv where nam = 2020 and thang = 11 and a.manvien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'manv'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/16/2020 5:28:25 PM
SqlContent: select a.MaNVien,b.TenNVien,b.MaCVu, b.MaBP LNGAYCONG, LTC, LPCCOM, LPCCVU, LPCDHAI, LBHXH0, LBHYT0, LBHTN0,LBHXH1, LBHYT1, LBHTN1,LThucNhan, LGTBT, LGTGC, TNCThue, ThucLinh from ctbangluong a inner join dmnvien b on a.manvien=b.manv where nam = 2020 and thang = 11 and a.manvien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'manv'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/16/2020 5:40:25 PM
SqlContent: select a.MaNVien,b.TenNVien,b.MaCVu, b.MaBP LNGAYCONG, LTC, LPCCOM, LPCCVU, LPCDHAI, LBHXH0, LBHYT0, LBHTN0,LBHXH1, LBHYT1, LBHTN1,LThucNhan, LGTBT, LGTGC, TNCThue, ThucLinh from ctbangluong a inner join dmnvien b on a.manvien=b.manv where nam = 2020 and thang = 11 and a.manvien in (select manvien from ctluongnv where maPA = 'LUONGNC')
Error code: 207
Message: Invalid column name 'manv'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/16/2020 5:42:00 PM
SqlContent: update ctbangluong set LHD= ROUND(b.LuongThang*b.NgayCong/b.b.Songay,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 207
Message: Invalid column name 'b'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:42:00 PM
SqlContent: select a.MaNVien,b.TenNVien,b.MaCVu, b.MaBP LHD, LTC, LPCCOM, LPCCVU, LPCDHAI, LBHXH0, LBHYT0, LBHTN0,LBHXH1, LBHYT1, LBHTN1,LThucNhan, LGTBT, LGTGC, TNCThue, ThucLinh from ctbangluong a inner join dmnvien b on a.manvien=b.manv where nam = 2020 and thang = 11 and a.manvien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 207
Message: Invalid column name 'manv'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/16/2020 5:43:17 PM
SqlContent: update ctbangluong set LHD= ROUND(b.LuongThang*b.NgayCong/b.b.Songay,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 207
Message: Invalid column name 'b'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 5:46:20 PM
SqlContent: update ctbangluong set LHD= ROUND(b.LuongThang*b.NgayCong/b.b.Songay,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 207
Message: Invalid column name 'b'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:14 PM
SqlContent: update ctbangluong set LHD= ROUND(@LuongThang*@NgayCong/26,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongThang".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LTC= @OT15*1.5 + @OT20*2+@OT30*3 from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@OT15".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LPCCom= @PCCom from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@PCCom".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LPCCVu= @PCCVu from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@PCCVu".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LPCDHai= @PCDHai from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@PCDHai".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHXH0= ROUND(@LuongBH*17.5/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHYT0= ROUND(@LuongBH*3/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHTN0= ROUND(@LuongBH*1/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHXH1= ROUND(@LuongBH*8/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHYT1= ROUND(@LuongBH*1.5/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LBHTN1= ROUND(@LuongBH*1/100,0) from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@LuongBH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LGTBT= @GTBT from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@GTBT".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/16/2020 6:05:19 PM
SqlContent: update ctbangluong set LGTGC= @GTGC from ctbangluong a  inner join ctytl b on a.manvien=b.manvien and a.nam=b.nam and a.thang=b.thang where a.nam = 2020 and a.thang=11 and a.MaNVien in (select manvien from ctluongnv where maPA = 'LUONGVP')
Error code: 137
Message: Must declare the scalar variable "@GTGC".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/17/2020 9:19:28 AM
SqlContent: select top 5 SoCT from MT82 where month(NgayCT)=month('11/17/2020') and year(NgayCT)=year('11/17/2020') and SoCT like 'BL20.11.%'  order by SoCT desc
Error code: 207
Message: Invalid column name 'NgayCT'.
Invalid column name 'NgayCT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/18/2020 11:06:03 AM
SqlContent: insert ctYTL(MaNVien, nam, thang,MaPA) select MaNVien,2020,11,LUONGVP from ctLuongnv  where maPA='LUONGVP' and MaNVien not in (select MaNVien from ctYTL where nam=2020 and thang=11)
Error code: 207
Message: Invalid column name 'LUONGVP'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/18/2020 11:06:03 AM
SqlContent: insert ctBangluong(MaNVien, nam, thang, MaPA) select MaNVien,2020,11,LUONGVP from ctLuongnv  where maPA='LUONGVP' and MaNVien not in (select MaNVien from ctBangluong where nam=2020 and thang=11)
Error code: 207
Message: Invalid column name 'LUONGVP'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/18/2020 11:06:51 AM
SqlContent: insert ctYTL(MaNVien, nam, thang,MaPA) select MaNVien,2020,11,LUONGVP from ctLuongnv  where maPA='LUONGVP' and MaNVien not in (select MaNVien from ctYTL where nam=2020 and thang=11)
Error code: 207
Message: Invalid column name 'LUONGVP'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/18/2020 11:06:51 AM
SqlContent: insert ctBangluong(MaNVien, nam, thang, MaPA) select MaNVien,2020,11,LUONGVP from ctLuongnv  where maPA='LUONGVP' and MaNVien not in (select MaNVien from ctBangluong where nam=2020 and thang=11)
Error code: 207
Message: Invalid column name 'LUONGVP'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/19/2020 4:01:58 PM
SqlContent: select a.*, b.*, c.TenBP, d.TenCvu, 
Luong=LNgayCong+LHD+LDS+LTC,
PC=PCCom+PCDHai+PCCvu+PCNha+PCDThoai+PCXang,
BH0=b.BHXH0+b.BHYT0+b.BHTN0,
 BH1=b.BHXH1+b.BHYT1+b.BHTN1,
GT=LGTBT+LGTGC
 from
MT82 a inner join dt82 b on a.MT82ID=b.MT82ID
left join dmBophan c on b.MaBP=c.MaBP
left join dmCVu d on b.MaCvu=d.MaCvu
where a.MT82ID=@@Mt82ID
Error code: 137
Message: Must declare the scalar variable "@@Mt82ID".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/19/2020 4:02:18 PM
SqlContent: select a.*, b.*, c.TenBP, d.TenCvu, 
Luong=LNgayCong+LHD+LDS+LTC,
PC=PCCom+PCDHai+PCCvu+PCNha+PCDThoai+PCXang,
BH0=b.BHXH0+b.BHYT0+b.BHTN0,
 BH1=b.BHXH1+b.BHYT1+b.BHTN1,
GT=LGTBT+LGTGC
 from
MT82 a inner join dt82 b on a.MT82ID=b.MT82ID
left join dmBophan c on b.MaBP=c.MaBP
left join dmCVu d on b.MaCvu=d.MaCvu
where a.MT82ID=@@Mt82ID
Error code: 137
Message: Must declare the scalar variable "@@Mt82ID".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/19/2020 4:02:21 PM
SqlContent: select a.*, b.*, c.TenBP, d.TenCvu, 
Luong=LNgayCong+LHD+LDS+LTC,
PC=PCCom+PCDHai+PCCvu+PCNha+PCDThoai+PCXang,
BH0=b.BHXH0+b.BHYT0+b.BHTN0,
 BH1=b.BHXH1+b.BHYT1+b.BHTN1,
GT=LGTBT+LGTGC
 from
MT82 a inner join dt82 b on a.MT82ID=b.MT82ID
left join dmBophan c on b.MaBP=c.MaBP
left join dmCVu d on b.MaCvu=d.MaCvu
where a.MT82ID=@@Mt82ID
Error code: 137
Message: Must declare the scalar variable "@@Mt82ID".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 11/26/2020 10:57:03 AM
SqlContent: insert into sysTable(sysPackageID,TableName,DienGiai,DienGiai2,Pk,Type,System,SortOrder,MasterTable,ParentPk,useBand,MaCT,Report,CollectType,sysUserid,App) values(@sysPackageID,@TableName,@DienGiai,@DienGiai2,@Pk,@Type,@System,@SortOrder,@MasterTable,@ParentPk,@useBand,@MaCT,@Report,@CollectType,@sysUserid,@App)--dmTrinhdo-Danh mục trình độ học vấn--MaTD-1-False----False---0--
Error code: 515
Message: Cannot insert the value NULL into column 'sysPackageID', table 'CDTSGD200.dbo.sysTable'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 11/27/2020 5:52:42 PM
SqlContent: DECLARE @NGAYCT1  DATETIME 
 DECLARE @NGAYCT2 DATETIME 
  DECLARE @NGAYDAUNAM DATETIME 
   SET  @NGAYCT1=  '01/01/2020 00:00:00'--'01/01/2015'--
   SET  @NGAYCT2=    '12/31/2020 00:00:00'--'12/31/2015'--
   DECLARE @MACONGTRINH NVARCHAR(32)
   SET @MACONGTRINH=@@MACONGTRINH
   SELECT MACONGTRINH INTO #DMCONGTRINH FROM DMCONGTRINH WHERE 1=0
   IF(@MACONGTRINH='')
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH
END
ELSE
BEGIN
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH=@MACONGTRINH
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	INSERT INTO #DMCONGTRINH (MACONGTRINH) SELECT MACONGTRINH FROM DMCONGTRINH WHERE MACONGTRINH NOT IN (SELECT MACONGTRINH FROM #DMCONGTRINH) AND MACONGTRINHME IN (SELECT MACONGTRINH FROM #DMCONGTRINH)

END

   SET @NGAYDAUNAM= CONVERT(DATETIME,'01/01'+'/'+ CONVERT(NVARCHAR(4), YEAR(@NGAYCT1)))  
   CREATE  TABLE #TAM   (   [MACONGTRINH] [NVARCHAR]  (50) NULL ,
       [DD]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,
          [GIATHANHTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOTK]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,    
          [GIATHANHLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKDN]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [GIATHANHLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [CPQLLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [DTLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0,   
          [LAILOLKKC]  [DECIMAL] (18,3) NOT NULL DEFAULT 0.0  ) ON [PRIMARY]   
--DỞ DANG ĐẦU KỲ  
INSERT INTO #TAM (MACONGTRINH, DD)   
SELECT MACONGTRINH, DD FROM  (
   SELECT MACONGTRINH, SUM(TIEN) AS DD FROM   (
        SELECT MACONGTRINH,SUM(DUNO) AS TIEN FROM OBTK WHERE TK LIKE '154%' GROUP BY MACONGTRINH     
        UNION ALL     
        SELECT MACONGTRINH,SUM(PSNO-PSCO)AS TIEN FROM BLTK WHERE  TK='154' AND NGAYCT<@NGAYCT1 GROUP BY MACONGTRINH   
        )X GROUP BY MACONGTRINH  )Y WHERE MACONGTRINH IS NOT NULL   
--PHÁT SINH TRONG KỲ  
INSERT INTO #TAM (MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,LAILOTK)   
SELECT MACONGTRINH, GIATHANHTK,CPQLTK, DTTK,-GIATHANHTK-CPQLTK+ DTTK FROM  (
   SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHTK, 0.0 AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL 
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK, SUM(PSCO) AS CPQLTK, 0.0 AS DTTK 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH   
   UNION ALL   
   SELECT MACONGTRINH, 0.0 AS GIATHANHTK,0.0 AS CPQLTK, SUM(PSNO) AS DTTK 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  
	GROUP BY MACONGTRINH  
   )X  
INSERT INTO #TAM (MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,LAILOLKDN)   
SELECT MACONGTRINH, GIATHANHLKDN,CPQLLKDN, DTLKDN,-GIATHANHLKDN-CPQLLKDN+ DTLKDN FROM  (
  -- LŨY KẾ TỪ ĐẦU NĂM   
  SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKDN, 0.0 AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN, SUM(PSCO) AS CPQLLKDN, 0.0 AS DTLKDN 
	FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
  UNION ALL   
  SELECT MACONGTRINH, 0.0 AS GIATHANHLKDN,0.0 AS CPQLLKDN, SUM(PSNO) AS DTLKDN 
	FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND  NGAYCT BETWEEN @NGAYDAUNAM AND @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
  )X  
  -- LŨY KẾ TỪ KHI KHỞI CÔNG  
  INSERT INTO #TAM (MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,LAILOLKKC)   
  SELECT MACONGTRINH, GIATHANHLKKC,CPQLLKKC, DTLKKC,-GIATHANHLKKC-CPQLLKKC+ DTLKKC FROM  (
     SELECT MACONGTRINH, SUM(PSCO) AS GIATHANHLKKC, 0.0 AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK='632' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC, SUM(PSCO) AS CPQLLKKC, 0.0 AS DTLKKC 
		FROM BLTK WHERE TK LIKE '642%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH   
     UNION ALL   
     SELECT MACONGTRINH, 0.0 AS GIATHANHLKKC,0.0 AS CPQLLKKC, SUM(PSNO) AS DTLKKC 
		FROM BLTK WHERE TK LIKE '511%' AND TKDU  LIKE '911%' AND NGAYCT <= @NGAYCT2 AND MACONGTRINH IS NOT NULL  GROUP BY MACONGTRINH  
     )X    
 SELECT B.MACONGTRINHME,X.*,B.TENCONGTRINH FROM  (
    SELECT MACONGTRINH, SUM(DD) AS DD, SUM(GIATHANHTK) AS GIATHANHTK, SUM(CPQLTK) AS CPQLTK, SUM(DTTK) AS DTTK, SUM(LAILOTK) AS LAILOTK,
         SUM(GIATHANHLKDN+CPQLLKDN) AS TCPKDN, SUM(DTLKDN) AS DTLKDN, SUM(LAILOLKDN) AS LAILOLKDN,
         SUM(GIATHANHLKKC+CPQLLKKC) AS TCPLKKC, SUM(DTLKKC) AS DTLKKC, SUM(LAILOLKKC) AS LAILOLKKC
         FROM #TAM GROUP BY MACONGTRINH  
     )X INNER JOIN DMCONGTRINH B ON X.MACONGTRINH=B.MACONGTRINH 
		WHERE (TCPLKKC<>0 OR DTLKKC<>0 OR LAILOLKKC<>0) AND B.MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
UNION ALL
SELECT '', N'ZTỔNG CỘNG', SUM(DD), SUM([GIATHANHTK]),SUM([CPQLTK]),   SUM([DTTK]),   SUM([LAILOTK]),
	SUM(GIATHANHLKDN+CPQLLKDN),  SUM([DTLKDN] ),SUM([LAILOLKDN]), SUM(GIATHANHLKKC+CPQLLKKC),   SUM([DTLKKC]),SUM([LAILOLKKC]),N'ZTỔNG CỘNG'
FROM #TAM WHERE  MACONGTRINH IN (SELECT MACONGTRINH FROM #DMCONGTRINH)
	DROP TABLE #DMCONGTRINH
     DROP TABLE #TAM  
Error code: 137
Message: Must declare the scalar variable "@@MACONGTRINH".
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 11/30/2020 1:54:19 PM
SqlContent:  insert into bltk(MTID,Nhomdk,MaCT,SoCT,NgayCT,Ongba,DienGiai,TK,TKdu,Psno,Psco) values(convert( uniqueidentifier,'00000000-0000-0000-0000-000000000000'),'KC',KCNLV,'KCNLV/12',cast('12/31/2020 00:00:00' as datetime),'',N' Kết chuyển nguyên vật liệu tháng 12\2020','6211','154',0,0)
Error code: 128
Message: The name "KCNLV" is not permitted in this context. Valid expressions are constants, constant expressions, and (in some contexts) variables. Column names are not permitted.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.insertRow(String tableName, List`1 fieldName, List`1 values) in D:\SGDPV\CDTDatabase\Database.cs:line 923
-------------------------------
 Log at 11/30/2020 1:59:13 PM
SqlContent: DECLARE @TK VARCHAR(16)
SET @TK = '' + '%'
IF (@TK = '%')
BEGIN
	SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A 
	LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT WHERE    1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00'   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
END
ELSE
BEGIN
	DECLARE @LOAIDK INT
	SET @LOAIDK = 
	IF @LOAIDK = 0
	BEGIN
		SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
		LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
		 WHERE   1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND (A.TK LIKE @TK )   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
	END
	ELSE
	BEGIN
		IF @LOAIDK = 1
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE  1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSNO > 0) ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
		ELSE
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE 1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSCO > 0)ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
	END
END


Error code: 156
Message: Incorrect syntax near the keyword 'IF'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 11/30/2020 3:44:41 PM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,MaPhi,MaVV,PsNoNT,MaNT,OngBa,MaBP,TyGia,MTIDDT,MaHD,MaCongtrinh,MaCN,NhomDk) select MT33.MaCT,MT33.MT33ID,MT33.SoCT,MT33.NgayCT,MT33.DienGiai,MT33.MaKH,DT33.TkHTL,MT33.TKCo,DT33.Ps,DT33.Maphi,DT33.MaVV,DT33.PsNT,MT33.MaNT,MT33.OngBa,DT33.MaBP,MT33.TyGia,DT33.DT33ID,DT33.MaHD,DT33.MaCongtrinh,MT33.MaCN,'HTL1' from MT33 inner join DT33 on MT33.MT33ID = DT33.MT33ID where MT33.MT33ID = 'd1f11bfc-6530-48ee-9c65-74fd2fb3bd29'
Error code: 1205
Message: Transaction (Process ID 124) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/30/2020 3:44:46 PM
SqlContent: delete from BLTK where MTID = 'd1f11bfc-6530-48ee-9c65-74fd2fb3bd29' and NhomDk = 'HTL2'
Error code: 1205
Message: Transaction (Process ID 124) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 11/30/2020 3:45:08 PM
SqlContent: delete from BLTK where MTID = 'd1f11bfc-6530-48ee-9c65-74fd2fb3bd29' and NhomDk = 'HTL1'
Error code: 1205
Message: Transaction (Process ID 124) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 6:43:03 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '6611c335-3d81-4572-9090-674e74d59197'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 6:43:03 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '6611c335-3d81-4572-9090-674e74d59197'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 6:43:03 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '6611c335-3d81-4572-9090-674e74d59197'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 6:43:03 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '6611c335-3d81-4572-9090-674e74d59197'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 6:57:20 AM
SqlContent: insert into MT3B(MaCT,MT3BID,sysDBID,NgayCT,SoCT,MaCN,TTienH,TThue,TTien,MaKH,TienKT,TThua,MaNVien,TaskID,Approved) values(@MaCT,@MT3BID,@sysDBID,@NgayCT,@SoCT,@MaCN,@TTienH,@TThue,@TTien,@MaKH,@TienKT,@TThua,@MaNVien,@TaskID,@Approved)-BL-a8fe3338-1b12-4a1f-9e1d-80b650775fdb-2-12/01/2020 00:00:00-BLYYMM0000-05-377045-37705-414750-KLE-001-0--414750-SGD--0
Error code: 2627
Message: Violation of PRIMARY KEY constraint 'PK_MT3B'. Cannot insert duplicate key in object 'dbo.MT3B'. The duplicate key value is (a8fe3338-1b12-4a1f-9e1d-80b650775fdb).
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 12/01/2020 7:23:30 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '200e69a6-2f13-4948-9298-ba82381b576a'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:23:31 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '200e69a6-2f13-4948-9298-ba82381b576a'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:23:31 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '200e69a6-2f13-4948-9298-ba82381b576a'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:23:31 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '200e69a6-2f13-4948-9298-ba82381b576a'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:25:43 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:25:44 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:25:44 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:25:44 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:19 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:20 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:20 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:20 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'ef566426-742e-47db-b5af-191a1ba4c303'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:55 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'a7c383c8-467d-4056-bc6a-d92d7019886c'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:55 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'a7c383c8-467d-4056-bc6a-d92d7019886c'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:56 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'a7c383c8-467d-4056-bc6a-d92d7019886c'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:26:56 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'a7c383c8-467d-4056-bc6a-d92d7019886c'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:29:23 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'e7149141-eac7-41d1-abe8-a693264a6137'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:29:24 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'e7149141-eac7-41d1-abe8-a693264a6137'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:29:24 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'e7149141-eac7-41d1-abe8-a693264a6137'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:29:24 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = 'e7149141-eac7-41d1-abe8-a693264a6137'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:40:18 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,HanNo,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,'1311',DT3B.TKDT,DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.DT3BID,MT3B.MaCN,0,'BL01' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '78dfb6ab-a7ff-48ca-af74-0b7bcaf57645'
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:40:18 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKDT,'1311',DT3B.PsCT,DT3B.PsCT,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL02' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '78dfb6ab-a7ff-48ca-af74-0b7bcaf57645'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:40:19 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsCo,PsCoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKKho,DT3B.TKGV,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL05' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '78dfb6ab-a7ff-48ca-af74-0b7bcaf57645'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:40:19 AM
SqlContent: insert into BLTK(MaCT,MTID,SoCT,NgayCT,DienGiai,MaKH,TK,TKDu,PsNo,PsNoNT,MaNT,TyGia,MTIDDT,MaCN,NhomDk) select MT3B.MaCT,MT3B.MT3BID,MT3B.SoCT,MT3B.NgayCT,N'Bán lẻ',MT3B.MaKH,DT3B.TKGV,DT3B.TKKho,DT3B.TienVon,DT3B.TienVon,'VND',1,DT3B.MT3BID,MT3B.MaCN,'BL06' from MT3B inner join DT3B on MT3B.MT3BID = DT3B.MT3BID where MT3B.MT3BID = '78dfb6ab-a7ff-48ca-af74-0b7bcaf57645'
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBABPM.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 12/01/2020 7:48:02 AM
SqlContent: select * from sysTable t left join sysUserTable ut on t.sysTableID = ut.sysTableID where t.sysTableID = DMVT
Error code: 207
Message: Invalid column name 'DMVT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 12/01/2020 7:48:02 AM
SqlContent: select * from sysTable t left join sysUserTable ut on t.sysTableID = ut.sysTableID where t.sysTableID = 'DMVT' and t.sysPackageID = 5
Error code: 245
Message: Conversion failed when converting the varchar value 'DMVT' to data type int.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at System.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at System.Data.SqlClient.SqlDataReader.Read()
   at System.Data.Common.DataAdapter.FillLoadDataRow(SchemaMapping mapping)
   at System.Data.Common.DataAdapter.FillFromReader(DataSet dataset, DataTable datatable, String srcTable, DataReaderContainer dataReader, Int32 startRecord, Int32 maxRecords, DataColumn parentChapterColumn, Object parentChapterValue)
   at System.Data.Common.DataAdapter.Fill(DataTable[] dataTables, IDataReader dataReader, Int32 startRecord, Int32 maxRecords)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 12/10/2020 10:54:15 AM
SqlContent: DECLARE @TK VARCHAR(16)
SET @TK = '' + '%'
IF (@TK = '%')
BEGIN
	SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A 
	LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT WHERE    1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00'   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
END
ELSE
BEGIN
	DECLARE @LOAIDK INT
	SET @LOAIDK = 
	IF @LOAIDK = 0
	BEGIN
		SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
		LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
		 WHERE   1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND (A.TK LIKE @TK )   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
	END
	ELSE
	BEGIN
		IF @LOAIDK = 1
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE  1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSNO > 0) ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
		ELSE
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE 1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSCO > 0)ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
	END
END


Error code: 156
Message: Incorrect syntax near the keyword 'IF'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 12/12/2020 9:53:35 AM
SqlContent: DECLARE @TK VARCHAR(16)
SET @TK = '' + '%'
IF (@TK = '%')
BEGIN
	SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A 
	LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT WHERE    1 = 1 and a.NgayCT >= '12/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00'   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
END
ELSE
BEGIN
	DECLARE @LOAIDK INT
	SET @LOAIDK = 
	IF @LOAIDK = 0
	BEGIN
		SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
		LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
		 WHERE   1 = 1 and a.NgayCT >= '12/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND (A.TK LIKE @TK )   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
	END
	ELSE
	BEGIN
		IF @LOAIDK = 1
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE  1 = 1 and a.NgayCT >= '12/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSNO > 0) ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
		ELSE
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE 1 = 1 and a.NgayCT >= '12/01/2020 00:00:00' and a.NgayCT <= '12/31/2020 00:00:00' AND  (A.TK LIKE @TK AND PSCO > 0)ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
	END
END


Error code: 156
Message: Incorrect syntax near the keyword 'IF'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 12/12/2020 10:33:40 AM
SqlContent: select MaVT from dttmp where 1=0
Error code: 207
Message: Invalid column name 'MaVT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 12/12/2020 10:33:54 AM
SqlContent: select MaVT from dttmp where 1=0
Error code: 207
Message: Invalid column name 'MaVT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 12/12/2020 11:20:17 AM
SqlContent: DECLARE @KH VARCHAR(16)
DECLARE @TKRP VARCHAR(16)
DECLARE @NOCODK BIT
DECLARE @NOCOCK BIT
DECLARE @TENKH NVARCHAR(128)
SET @TKRP='131'--'1311'--
SET @KH='LXE'--'NAI36-122'--
SET @TENKH = (SELECT DISTINCT TENKH FROM DMKH WHERE MAKH=@KH)
DECLARE @NGAYCT1 DATETIME
DECLARE @NGAYCT2 DATETIME
SET @NGAYCT1=CAST('01/01/2020 00:00:00' AS DATETIME)--'01/01/2018'--
SET @NGAYCT2=CAST('12/31/2020 00:00:00' AS DATETIME)--'03/31/2018'--
DECLARE @DAUKY FLOAT
--TÌM SỐ DƯ ĐẦU KỲ=SỐ DƯ ĐẦU NĂM + SỐ PHÁT SINH TRƯỚC NGÀYCT1
	
	DECLARE @DAUNAM FLOAT
	DECLARE @COUNT1 INT 
	--SỐ PHÁT INH ĐẦU NĂM
	SET @DAUNAM=(SELECT SUM(DUNO-DUCO) FROM OBTK WHERE  LEFT(TK,LEN(@TKRP))=@TKRP AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM OBTK WHERE  LEFT(TK,LEN(@TKRP))=@TKRP AND MAKH=@KH)
	SET @DAUNAM = CASE WHEN @COUNT1<>0 THEN @DAUNAM ELSE 0 END
	SET @DAUKY=(SELECT SUM(PSNO)-SUM(PSCO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND NDECLARE @KH VARCHAR(16)
DECLARE @TKRP VARCHAR(16)
DECLARE @NOCODK BIT
DECLARE @NOCOCK BIT
DECLARE @TENKH NVARCHAR(128)
SET @TKRP='131'--'131'--
SET @KH='LXE'--'LXE'--
SET @TENKH = (SELECT DISTINCT TENKH FROM DMKH WHERE MAKH=@KH)
DECLARE @NGAYCT1 DATETIME
DECLARE @NGAYCT2 DATETIME
SET @NGAYCT1=CAST('01/01/2020 00:00:00' AS DATETIME)--'01/01/2018'--
SET @NGAYCT2=CAST('12/31/2020 00:00:00' AS DATETIME)--'12/31/2021'--
DECLARE @DAUKY FLOAT
--TÌM SỐ DƯ ĐẦU KỲ=SỐ DƯ ĐẦU NĂM + SỐ PHÁT SINH TRƯỚC NGÀYCT1
	
	DECLARE @DAUNAM FLOAT
	DECLARE @COUNT1 INT 
	--SỐ PHÁT INH ĐẦU NĂM
	SET @DAUNAM=(SELECT SUM(DUNO-DUCO) FROM OBTK WHERE  LEFT(TK,LEN(@TKRP))=@TKRP AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM OBTK WHERE  LEFT(TK,LEN(@TKRP))=@TKRP AND MAKH=@KH)
	SET @DAUNAM = CASE WHEN @COUNT1<>0 THEN @DAUNAM ELSE 0 END
	SET @DAUKY=(SELECT SUM(PSNO)-SUM(PSCO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND NGAYCT<@NGAYCT1 AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND NGAYCT<@NGAYCT1 AND MAKH=@KH)
	SET @DAUKY=CASE WHEN @COUNT1>0 THEN @DAUKY ELSE 0 END

	SET @DAUKY=@DAUKY + @DAUNAM
	SET @NOCODK = CASE WHEN @DAUKY>=0 THEN 1 ELSE 0 END

--TÌM SỐ DƯ CUỐI KỲ
	DECLARE @PSNO FLOAT
	DECLARE @PSCO FLOAT
	DECLARE @CUOIKY FLOAT 
	SET @PSNO=(SELECT SUM(PSNO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @PSCO=(SELECT SUM(PSCO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @PSNO=CASE WHEN @COUNT1>0 THEN @PSNO ELSE 0 END
	SET @PSCO=CASE WHEN @COUNT1>0 THEN @PSCO ELSE 0 END
	SET @CUOIKY=@DAUKY + @PSNO-@PSCO
	SET @NOCOCK = CASE WHEN @CUOIKY>=0 THEN 1 ELSE 0 END

--LẤY SỐ PHÁT SINH

DECLARE @NOPHATSINH FLOAT
DECLARE @PHATSINHCO FLOAT
SELECT @NOPHATSINH=SUM(PSNO) FROM BLTK A WHERE LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH 
SELECT @PHATSINHCO=SUM(PSCO) FROM BLTK A WHERE LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH 
SELECT NGAYCT,MTID, MACT,SOCT,DIENGIAI, PSNO,PSCO ,MAKH,TENKH, @DAUKY AS LUYKE, NHOMDK INTO #T FROM (
	---PHIEU XUAT BAN HÀNG(LINKD SO HOA DON NGAY HD)

			SELECT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,SUM(A.PSNO) AS PSNO,SUM(PSCO) AS PSCO ,A.MAKH,B.TENKH, NHOMDK
			FROM BLTK A
			LEFT JOIN DMKH B ON A.MAKH = B.MAKH
			WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH  AND (PSNO<>0 OR PSCO<>0)
			GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH, NHOMDK
			)X
	ORDER BY NGAYCT, MACT DESC, SOCT, NHOMDK

-----------------------------
SELECT  NGAYCT, MACT, SOCT,MTID,  PSNO-PSCO AS PS, NHOMDK INTO #TT FROM #T

-----------------------------
DECLARE CUR CURSOR FOR 
SELECT MTID, PS, NHOMDK FROM #TT ORDER BY NGAYCT, MACT DESC, SOCT
OPEN CUR
DECLARE @MTID UNIQUEIDENTIFIER
DECLARE @PS FLOAT
DECLARE @LUYKE FLOAT
DECLARE @NHOMDK NVARCHAR(32)
SET @LUYKE = @DAUKY
FETCH CUR INTO @MTID, @PS,@NHOMDK

WHILE(@@FETCH_STATUS=0)
BEGIN
PRINT @LUYKE
	SET @LUYKE=@LUYKE+@PS
	UPDATE #T SET LUYKE=@LUYKE WHERE MTID=@MTID AND NHOMDK=@NHOMDK
	 UPDATE #T SET LUYKE=-1*@LUYKE WHERE MTID=@MTID AND LEFT(@TKRP,3)='331' AND NHOMDK=@NHOMDK
	FETCH CUR INTO @MTID, @PS, @NHOMDK
END
CLOSE CUR
DEALLOCATE CUR

SELECT MTID,NGAYCT,MACT,SOCT,DIENGIAI,SOPS,PSCO,MAKH,TENKH,LUYKE AS SODU
FROM(
SELECT 1 AS SORT, @NGAYCT1 AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=CASE WHEN @NOCODK=1 THEN N'SỐ DƯ NỢ ĐẦU KỲ' ELSE N'SỐ DƯ CÓ ĐẦU KỲ' END ,
 SOPS=CASE WHEN @NOCODK=1 THEN ABS(@DAUKY) ELSE 0 END, PSCO=CASE WHEN @NOCODK=1 THEN 0 ELSE ABS(@DAUKY) END, @KH AS MAKH, @TENKH AS TENKH,
 CASE WHEN LEFT(@TKRP,3)='331' THEN -1*@DAUKY ELSE @DAUKY END AS LUYKE, '' AS NHOMDK
UNION ALL
SELECT DISTINCT 2 AS SORT,NGAYCT, MTID, MACT, SOCT, DIENGIAI, PSNO, PSCO, MAKH, TENKH,LUYKE, NHOMDK  FROM #T
UNION ALL
SELECT 3 AS SORT, DATEADD(S,1,@NGAYCT2)  AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=N'TỔNG PHÁT SINH' ,
	@NOPHATSINH AS SOPS,@PHATSINHCO AS PSCO, NULL AS MAKH, NULL AS TENKH, 0,''
UNION ALL
SELECT 4 AS SORT, DATEADD(S,2,@NGAYCT2)  AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=CASE WHEN @NOCOCK=1 THEN N'SỐ DƯ NỢ CUỐI KỲ' ELSE N'SỐ DƯ CÓ CUỐI KỲ' END ,
	SOPS=CASE WHEN @NOCOCK=1 THEN ABS(@CUOIKY) ELSE 0 END, PSCO=CASE WHEN @NOCOCK=1 THEN 0 ELSE ABS(@CUOIKY) END, NULL AS MAKH, NULL AS TENKH, 
	 CASE WHEN LEFT(@TKRP,3)='331' THEN -1*@CUOIKY ELSE @CUOIKY END, ''
)X
ORDER BY SORT,NGAYCT, MACT DESC, SOCT, NHOMDK
	DROP TABLE #T
	DROP TABLE #TT
GAYCT<@NGAYCT1 AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND NGAYCT<@NGAYCT1 AND MAKH=@KH)
	SET @DAUKY=CASE WHEN @COUNT1>0 THEN @DAUKY ELSE 0 END

	SET @DAUKY=@DAUKY + @DAUNAM
	SET @NOCODK = CASE WHEN @DAUKY>=0 THEN 1 ELSE 0 END

--TÌM SỐ DƯ CUỐI KỲ
	DECLARE @PSNO FLOAT
	DECLARE @PSCO FLOAT
	DECLARE @CUOIKY FLOAT 
	SET @PSNO=(SELECT SUM(PSNO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @PSCO=(SELECT SUM(PSCO)FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @COUNT1=(SELECT COUNT(*) FROM BLTK WHERE LEFT(TK,LEN(@TKRP))=@TKRP AND (NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2)AND MAKH=@KH)
	SET @PSNO=CASE WHEN @COUNT1>0 THEN @PSNO ELSE 0 END
	SET @PSCO=CASE WHEN @COUNT1>0 THEN @PSCO ELSE 0 END
	SET @CUOIKY=@DAUKY + @PSNO-@PSCO
	SET @NOCOCK = CASE WHEN @CUOIKY>=0 THEN 1 ELSE 0 END

--LẤY SỐ PHÁT SINH

DECLARE @NOPHATSINH FLOAT
DECLARE @PHATSINHCO FLOAT
SELECT @NOPHATSINH=SUM(PSNO) FROM BLTK A WHERE LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH 
SELECT @PHATSINHCO=SUM(PSCO) FROM BLTK A WHERE LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH 
SELECT *, @DAUKY AS LUYKE INTO #T FROM (
	---PHIEU XUAT BAN HÀNG(LINKD SO HOA DON NGAY HD)
	SELECT X.NGAYCT,MTID, X.MACT,X.SOCT,X.DIENGIAI, X.PSNO,X.PSCO ,X.MAKH,X.TENKH,NULL AS NGAYHD,NULL AS SOHOADON, NULL AS DTTHUE
	FROM (
			SELECT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,SUM(A.PSNO) AS PSNO,0 AS PSCO ,A.MAKH,B.TENKH
			FROM BLTK A
			LEFT JOIN DMKH B ON A.MAKH = B.MAKH
			WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH AND A.MACT NOT IN ('HDV','HDB','XBH')  AND (PSNO>0)
			GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH
		) X
	UNION ALL
	---PHIEU XUAT BAN HÀNG(LINKD SO HOA DON NGAY HD)
	SELECT X.NGAYCT,MTID, X.MACT,X.SOCT,X.DIENGIAI, X.PSNO,X.PSCO ,X.MAKH,X.TENKH,L.NGAYHD,L.SOHOADON, DTTHUE=CASE WHEN L.MADTTAX = 'NHANDUNGVAT' THEN 'ND' WHEN L.MADTTAX = 'KHAIHOANGVAT' THEN 'KH' ELSE NULL END
	FROM (
			SELECT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,SUM(A.PSNO) AS PSNO,0 AS PSCO ,A.MAKH,B.TENKH
			FROM BLTK A
			LEFT JOIN DMKH B ON A.MAKH = B.MAKH
			WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH AND A.MACT ='XBH' AND (PSNO>=0)
			GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH
		) X
	LEFT JOIN MT3A M ON X.MTID = M.MT3AID
	LEFT JOIN MT32 L ON M.MT32ID = L.MT32ID
	UNION ALL
	---HOA DON DICH VU (LINKD SO HOA DON NGAY HD KHACH PHIEU XUAT BAN)
	SELECT X.NGAYCT,MTID, X.MACT,X.SOCT,X.DIENGIAI, X.PSNO,X.PSCO ,X.MAKH,X.TENKH,M.NGAYCT AS NGAYHD,M.SOHOADON, DTTHUE=CASE WHEN M.MADTTAX = 'NHANDUNGVAT' THEN 'ND' WHEN M.MADTTAX = 'KHAIHOANGVAT' THEN 'KH' ELSE NULL END
	FROM (
			SELECT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,SUM(A.PSNO) AS PSNO,0 AS PSCO ,A.MAKH,B.TENKH
				FROM BLTK A
				LEFT JOIN DMKH B ON A.MAKH = B.MAKH
				WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH  AND (PSNO>0) AND A.MACT = 'HDV'
				GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH
		) X
		LEFT JOIN MT31 M ON X.MTID = M.MT31ID
	UNION ALL
	---DICH VU HOA DON (LINKD SO HOA DON NGAY HD KHACH PHIEU XUAT BAN)
	SELECT X.NGAYCT,MTID, X.MACT,X.SOCT,X.DIENGIAI, X.PSNO,X.PSCO ,X.MAKH,X.TENKH,M.NGAYHD,M.SOHOADON, DTTHUE=CASE WHEN M.MADTTAX = 'NHANDUNGVAT' THEN 'ND' WHEN M.MADTTAX = 'KHAIHOANGVAT' THEN 'KH' ELSE NULL END
	FROM (
		SELECT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,SUM(A.PSNO) AS PSNO,0 AS PSCO ,A.MAKH,B.TENKH
			FROM BLTK A
			LEFT JOIN DMKH B ON A.MAKH = B.MAKH
			WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH  AND (PSNO>0) AND A.MACT = 'HDB'
			GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH
			) X
		LEFT JOIN MT32 M ON X.MTID = M.MT32ID
	UNION ALL
	SELECT DISTINCT A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,0 AS PSNO,SUM(PSCO) AS PSCO ,A.MAKH,B.TENKH,NULL AS NGAYHD,NULL AS SOHOADON,NULL AS DTTHUE FROM BLTK A
		INNER JOIN DMKH B ON A.MAKH=B.MAKH 
		WHERE  LEFT(A.TK,LEN(@TKRP))=@TKRP AND (A.NGAYCT BETWEEN @NGAYCT1 AND @NGAYCT2 ) AND A.MAKH=@KH  AND (PSCO>0)
		GROUP BY A.NGAYCT,MTID, A.MACT,A.SOCT,A.DIENGIAI,A.MAKH,B.TENKH
	) X 
	ORDER BY NGAYCT, MACT DESC, SOCT
-----------------------------
SELECT DISTINCT NGAYCT, MACT, SOCT,MTID,  PSNO-PSCO AS PS INTO #TT FROM #T

-----------------------------
DECLARE CUR CURSOR FOR 
SELECT MTID, PS FROM #TT ORDER BY NGAYCT, MACT DESC, SOCT
OPEN CUR
DECLARE @MTID UNIQUEIDENTIFIER
DECLARE @PS FLOAT
DECLARE @LUYKE FLOAT
SET @LUYKE = @DAUKY
FETCH CUR INTO @MTID, @PS

WHILE(@@FETCH_STATUS=0)
BEGIN
PRINT @LUYKE
	SET @LUYKE=@LUYKE+@PS
	UPDATE #T SET LUYKE=@LUYKE WHERE MTID=@MTID
 UPDATE #T SET LUYKE=-1*@LUYKE WHERE MTID=@MTID AND LEFT(@TKRP,3)='331'
	FETCH CUR INTO @MTID, @PS
END
CLOSE CUR
DEALLOCATE CUR

SELECT MTID,NGAYCT,MACT,SOCT,DIENGIAI,SOPS,PSCO,MAKH,TENKH,NGAYHD,SOHOADON,DTTHUE,LUYKE AS SODU
FROM(
SELECT 1 AS SORT, @NGAYCT1 AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=CASE WHEN @NOCODK=1 THEN N'SỐ DƯ NỢ ĐẦU KỲ' ELSE N'SỐ DƯ CÓ ĐẦU KỲ' END ,
 SOPS=CASE WHEN @NOCODK=1 THEN ABS(@DAUKY) ELSE 0 END, PSCO=CASE WHEN @NOCODK=1 THEN 0 ELSE ABS(@DAUKY) END, @KH AS MAKH, @TENKH AS TENKH,NULL AS NGAYHD,NULL AS SOHOADON,NULL AS DTTHUE, CASE WHEN LEFT(@TKRP,3)='331' THEN -1*@DAUKY ELSE @DAUKY END AS LUYKE
UNION ALL
SELECT DISTINCT 2 AS SORT,* FROM #T
UNION ALL
SELECT 3 AS SORT, DATEADD(S,1,@NGAYCT2)  AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=N'TỔNG PHÁT SINH' ,
	@NOPHATSINH AS SOPS,@PHATSINHCO AS PSCO, NULL AS MAKH, NULL AS TENKH,NULL AS NGAYHD,NULL AS SOHOADON,NULL AS DTTHUE, 0
UNION ALL
SELECT 4 AS SORT, DATEADD(S,2,@NGAYCT2)  AS NGAYCT,NULL AS MTID,NULL AS MACT,NULL AS SOCT, DIENGIAI=CASE WHEN @NOCOCK=1 THEN N'SỐ DƯ NỢ CUỐI KỲ' ELSE N'SỐ DƯ CÓ CUỐI KỲ' END ,
	SOPS=CASE WHEN @NOCOCK=1 THEN ABS(@CUOIKY) ELSE 0 END, PSCO=CASE WHEN @NOCOCK=1 THEN 0 ELSE ABS(@CUOIKY) END, NULL AS MAKH, NULL AS TENKH,NULL AS NGAYHD,NULL AS SOHOADON,NULL AS DTTHUE,  CASE WHEN LEFT(@TKRP,3)='331' THEN -1*@CUOIKY ELSE @CUOIKY END
)X
ORDER BY SORT,NGAYCT, MACT DESC, SOCT
	DROP TABLE #T
	DROP TABLE #TT

Error code: 102
Message: Incorrect syntax near '@KH'.
The variable name '@TKRP' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@NOCODK' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@NOCOCK' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@TENKH' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@NGAYCT1' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@NGAYCT2' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@DAUKY' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@DAUNAM' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@COUNT1' has already been declared. Variable names must be unique within a query batch or stored procedure.
Incorrect syntax near 'GAYCT'.
The variable name '@PSNO' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@PSCO' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@CUOIKY' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@NOPHATSINH' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@PHATSINHCO' has already been declared. Variable names must be unique within a query batch or stored procedure.
There is already an object named '#T' in the database.
Incorrect syntax near 'X'.
There is already an object named '#TT' in the database.
The variable name '@MTID' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@PS' has already been declared. Variable names must be unique within a query batch or stored procedure.
The variable name '@LUYKE' has already been declared. Variable names must be unique within a query batch or stored procedure.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 12/21/2020 4:16:37 PM
SqlContent: delete from DMVT where MaVT = @MaVT-A
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_vatout_mavt". The conflict occurred in database "CBAHUYNGOCPHUONG", table "dbo.VATOUT", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 12/24/2020 5:56:54 PM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-4dced5c1-df5a-419c-bdfe-d14ddab912af-CONGTY--False-0--10/24/2020 00:00:00-MH20.0001-CONGTY-PNM-Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VN-10/24/2020 00:00:00-59--CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế-0--Mua hangf-VND-1.000000-3311-10-1331-100000-100000-10000-10000-110000-110000-0-True-0-0-01---0-0-1-7111-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD200", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 01/08/2021 3:37:47 PM
SqlContent: select top 50  0 as HasComment,* from MT3B where 1=1 order by NgayCT desc,Soct desc
Error code: 207
Message: Invalid column name 'stt'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataSetMasterDetail(String queryMaster, String queryDetail) in D:\SGDPV\CDTDatabase\Database.cs:line 195
-------------------------------
 Log at 01/11/2021 3:39:51 PM
SqlContent: select * from DMMau where MaMau in ('RED','MAVACH','BLACK')
Error code: 207
Message: Invalid column name 'MaMau'.
Invalid column name 'MaMau'.
Invalid column name 'MaMau'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet)
   at CDTDatabase.Database.GetDataSet(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 100
-------------------------------
 Log at 01/11/2021 3:47:42 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN Pressure
Error code: 5074
Message: The object 'DF_DMVT_Pressure' is dependent on column 'Pressure'.
ALTER TABLE DROP COLUMN Pressure failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 3:48:39 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN Thickness2
Error code: 5074
Message: The object 'DF_DMVT_Thickness2' is dependent on column 'Thickness2'.
ALTER TABLE DROP COLUMN Thickness2 failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 3:48:41 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN NOBolt
Error code: 5074
Message: The object 'DF_DMVT_NOBolt' is dependent on column 'NOBolt'.
ALTER TABLE DROP COLUMN NOBolt failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 3:48:42 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN Degree
Error code: 5074
Message: The object 'DF_DMVT_Degree' is dependent on column 'Degree'.
ALTER TABLE DROP COLUMN Degree failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 3:48:43 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN Density
Error code: 5074
Message: The object 'DF_DMVT_Density' is dependent on column 'Density'.
ALTER TABLE DROP COLUMN Density failed because one or more objects access this column.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 3:51:24 PM
SqlContent: select * from DMVT where Thickness1 is not null
Error code: 207
Message: Invalid column name 'Thickness1'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 01/11/2021 3:51:24 PM
SqlContent: ALTER TABLE DMVT DROP COLUMN Thickness1
Error code: 4924
Message: ALTER TABLE DROP COLUMN failed because column 'Thickness1' does not exist in table 'DMVT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/11/2021 4:12:51 PM
SqlContent: create table MT91(  MT91ID uniqueidentifier  not null , NgayCT smalldatetime, Số CT nvarchar(128), MaCT nvarchar(128), MaSP nvarchar(32), MT35ID uniqueidentifier , Sudung bit not null , TaskID uniqueidentifier , Approved int , ws nvarchar(4000),Grws nvarchar(4000) )
Error code: 102
Message: Incorrect syntax near 'nvarchar'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/12/2021 3:49:46 PM
SqlContent: delete from DMVT where MaVT = @MaVT-A
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_dt35_dmvt". The conflict occurred in database "CBAGIAYDA", table "dbo.DT35", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 01/12/2021 3:49:55 PM
SqlContent: delete from DMVT where MaVT = @MaVT-A
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_dt22_dmvt". The conflict occurred in database "CBAGIAYDA", table "dbo.DT22", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 01/13/2021 9:41:08 AM
SqlContent: create table DT92(  MT92ID uniqueidentifier  not null , DT92ID uniqueidentifier  not null , MT91ID uniqueidentifier  not null , MaSP nvarchar(32) not null , Soluong int  not null , Matgiay nvarchar(128), Maude nvarchar(128), Luoiga nvarchar(128), In nvarchar(128), Lotthan nvarchar(128), Lotco nvarchar(128), Mousse nvarchar(128), Phohau nvarchar(128), Day nvarchar(128), Talon nvarchar(128), Niso int , ws nvarchar(4000),Grws nvarchar(4000) )
Error code: 156
Message: Incorrect syntax near the keyword 'In'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/13/2021 10:02:04 AM
SqlContent: ALTER TABLE sysTable ADD  RowHeight int 
Error code: 2705
Message: Column names in each table must be unique. Column name 'RowHeight' in table 'sysTable' is specified more than once.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 01/18/2021 9:17:30 AM
SqlContent: DECLARE @TK VARCHAR(16)
SET @TK = '' + '%'
IF (@TK = '%')
BEGIN
	SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A 
	LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT WHERE    1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2021 00:00:00'   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
END
ELSE
BEGIN
	DECLARE @LOAIDK INT
	SET @LOAIDK = 
	IF @LOAIDK = 0
	BEGIN
		SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
		LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
		 WHERE   1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2021 00:00:00' AND (A.TK LIKE @TK )   ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
	END
	ELSE
	BEGIN
		IF @LOAIDK = 1
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE  1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2021 00:00:00' AND  (A.TK LIKE @TK AND PSNO > 0) ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
		ELSE
		BEGIN
			SELECT A.*,DMTK.TENTK, DMKH.TENKH,B.DIENGIAI AS TENCT FROM BLTK A
			LEFT JOIN DMKH ON A.MAKH=DMKH.MAKH
	LEFT JOIN DMTK ON A.TK=DMTK.TK
	LEFT JOIN DMCTGS B ON A.MACT = B.MACT
	 WHERE 1 = 1 and a.NgayCT >= '01/01/2020 00:00:00' and a.NgayCT <= '12/31/2021 00:00:00' AND  (A.TK LIKE @TK AND PSCO > 0)ORDER BY A.NGAYCT,A.SOCT, A.MTIDDT, NHOMDK
		END
	END
END


Error code: 156
Message: Incorrect syntax near the keyword 'IF'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 03/11/2021 12:24:50 AM
SqlContent: Connection String
Error code: -2
Message: Execution Timeout Expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at System.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at System.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at System.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at System.Data.SqlClient.TdsParserStateObject.TryReadByte(Byte& value)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransactionYukon(TransactionRequest transactionRequest, String transactionName, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnectionTds.ExecuteTransaction(TransactionRequest transactionRequest, String name, IsolationLevel iso, SqlInternalTransaction internalTransaction, Boolean isDelegateControlRequest)
   at System.Data.SqlClient.SqlInternalConnection.BeginSqlTransaction(IsolationLevel iso, String transactionName, Boolean shouldReconnect)
   at System.Data.SqlClient.SqlConnection.BeginTransaction(IsolationLevel iso, String transactionName)
   at System.Data.SqlClient.SqlConnection.BeginTransaction()
   at CDTDatabase.Database.OpenConnection() in D:\SGDPV\CDTDatabase\Database.cs:line 269
-------------------------------
 Log at 03/14/2021 2:29:02 PM
SqlContent: SELECT DMCONGTRINH.TENCONGTRINH,NGAYCT,SOCT,DMKH.TENKH,DIENGIAI,TK,TKDU AS TKDOIUNG,PSNO,PSCO
FROM BLTK,DMKH,DMCONGTRINH
WHERE DMKH.MAKH=*BLTK.MAKH AND  DMCONGTRINH.MACONGTRINH=BLTK.MACONGTRINH AND BLTK.MACONGTRINH='02/2020/TL-DK' AND 1 = 1 and NgayCT >= '01/01/2020 00:00:00' and NgayCT <= '12/31/2021 00:00:00' and TK like '154%'
Error code: 4147
Message: The query uses non-ANSI outer join operators ("*=" or "=*"). To run this query without modification, please set the compatibility level for current database to 80 or lower, using stored procedure sp_dbcmptlevel. It is strongly recommended to rewrite the query using ANSI outer join operators (LEFT OUTER JOIN, RIGHT OUTER JOIN). In the future versions of SQL Server, non-ANSI join operators will not be supported even in backward-compatibility modes.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 03/19/2021 9:18:26 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH----CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế--CONGTY-CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế--Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VN Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VNLô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VNLô CN1, cụm công ngh-3301642253-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:24:42 AM
SqlContent: insert into DMKH(MaHd,MauHd,Soseri,DoiTac,Email,MaKH,TenKH,Nhom1,DiaChi,MST,SDT,Mobile,Fax,TKNganHang,TenKH2,NganHang,IsNCC,IsKH,IsNV,Nhom2,Nhom3,Website,HopDong,MucNo,MaNVien,LoaiKH,MaCN,MaTT,Ghichu,HanNo,MaNVien1,MaHTTT,HTTT) values(@MaHd,@MauHd,@Soseri,@DoiTac,@Email,@MaKH,@TenKH,@Nhom1,@DiaChi,@MST,@SDT,@Mobile,@Fax,@TKNganHang,@TenKH2,@NganHang,@IsNCC,@IsKH,@IsNV,@Nhom2,@Nhom3,@Website,@HopDong,@MucNo,@MaNVien,@LoaiKH,@MaCN,@MaTT,@Ghichu,@HanNo,@MaNVien1,@MaHTTT,@HTTT)------345FSFSDF-f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdf f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf s--df--------False-False-False-----0---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:29:05 AM
SqlContent: insert into DMKH(MaHd,MauHd,Soseri,DoiTac,Email,MaKH,TenKH,Nhom1,DiaChi,MST,SDT,Mobile,Fax,TKNganHang,TenKH2,NganHang,IsNCC,IsKH,IsNV,Nhom2,Nhom3,Website,HopDong,MucNo,MaNVien,LoaiKH,MaCN,MaTT,Ghichu,HanNo,MaNVien1,MaHTTT,HTTT) values(@MaHd,@MauHd,@Soseri,@DoiTac,@Email,@MaKH,@TenKH,@Nhom1,@DiaChi,@MST,@SDT,@Mobile,@Fax,@TKNganHang,@TenKH2,@NganHang,@IsNCC,@IsKH,@IsNV,@Nhom2,@Nhom3,@Website,@HopDong,@MucNo,@MaNVien,@LoaiKH,@MaCN,@MaTT,@Ghichu,@HanNo,@MaNVien1,@MaHTTT,@HTTT)------345FSFSDF-f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdf f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf s--df--------False-False-False-----0---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:29:34 AM
SqlContent: insert into DMKH(MaHd,MauHd,Soseri,DoiTac,Email,MaKH,TenKH,Nhom1,DiaChi,MST,SDT,Mobile,Fax,TKNganHang,TenKH2,NganHang,IsNCC,IsKH,IsNV,Nhom2,Nhom3,Website,HopDong,MucNo,MaNVien,LoaiKH,MaCN,MaTT,Ghichu,HanNo,MaNVien1,MaHTTT,HTTT) values(@MaHd,@MauHd,@Soseri,@DoiTac,@Email,@MaKH,@TenKH,@Nhom1,@DiaChi,@MST,@SDT,@Mobile,@Fax,@TKNganHang,@TenKH2,@NganHang,@IsNCC,@IsKH,@IsNV,@Nhom2,@Nhom3,@Website,@HopDong,@MucNo,@MaNVien,@LoaiKH,@MaCN,@MaTT,@Ghichu,@HanNo,@MaNVien1,@MaHTTT,@HTTT)------345FSFSDF-f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdf f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf s--df--------False-False-False-----0---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:30:37 AM
SqlContent: insert into DMKH(MaHd,MauHd,Soseri,DoiTac,Email,MaKH,TenKH,Nhom1,DiaChi,MST,SDT,Mobile,Fax,TKNganHang,TenKH2,NganHang,IsNCC,IsKH,IsNV,Nhom2,Nhom3,Website,HopDong,MucNo,MaNVien,LoaiKH,MaCN,MaTT,Ghichu,HanNo,MaNVien1,MaHTTT,HTTT) values(@MaHd,@MauHd,@Soseri,@DoiTac,@Email,@MaKH,@TenKH,@Nhom1,@DiaChi,@MST,@SDT,@Mobile,@Fax,@TKNganHang,@TenKH2,@NganHang,@IsNCC,@IsKH,@IsNV,@Nhom2,@Nhom3,@Website,@HopDong,@MucNo,@MaNVien,@LoaiKH,@MaCN,@MaTT,@Ghichu,@HanNo,@MaNVien1,@MaHTTT,@HTTT)------345FSFSDF-f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdf f sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf sdfs fdsfdsfsdf dsf dsfsdfsdff sfs sfsdfsdfsdf s--df--------False-False-False-----0---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:32:49 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng 379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:37:50 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng 379 Cách Mạng T379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵngháng 8 - Quận Cẩm Lệ - Đà Nẵng--------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:41:48 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 9:42:42 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:03:58 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:05:29 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:07:14 AM
SqlContent: update DMKH set MaHd = @MaHd,MauHd = @MauHd,Soseri = @Soseri,DoiTac = @DoiTac,Email = @Email,TenKH = @TenKH,Nhom1 = @Nhom1,DiaChi = @DiaChi,MST = @MST,SDT = @SDT,Mobile = @Mobile,Fax = @Fax,TKNganHang = @TKNganHang,TenKH2 = @TenKH2,NganHang = @NganHang,IsNCC = @IsNCC,IsKH = @IsKH,IsNV = @IsNV,Nhom2 = @Nhom2,Nhom3 = @Nhom3,Website = @Website,HopDong = @HopDong,MucNo = @MucNo,MaNVien = @MaNVien,LoaiKH = @LoaiKH,MaCN = @MaCN,MaTT = @MaTT,Ghichu = @Ghichu,HanNo = @HanNo,MaNVien1 = @MaNVien1,MaHTTT = @MaHTTT,HTTT = @HTTT where MaKH = @MaKH------0401300642-Công ty TNHH Phát Triển Thế Hệ Kế Tiếp--379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123@$379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà NẵngAbc123-0401300642-------False-False-False-----0.000000---------
Error code: 8152
Message: String or binary data would be truncated.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:09:11 AM
SqlContent: insert into BLTK(MaCT,NgayCT,SoCT,MTID,MTIDDT,TK,TKDu,PsNo,MaBP,MaVV,MaPhi,MaNT,OngBa,DienGiai,TyGia,MaKH,MaCongtrinh,MaCN,NhomDk) select MT22.MaCT,MT22.NgayCT,MT22.SoCT,MT22.MT22ID,DT22.DT22ID,DT22.TKCp,DT22.TKNo,ps-case when tkck  like '711%' then 0 else ck end,DT22.MaBP,DT22.MaVV,DT22.MaPhi,MT22.MaNT,MT22.OngBa,MT22.DienGiai,MT22.TyGia,MT22.MaKH,DT22.MaCongtrinh,MT22.MaCN,'PNM9' from MT22 inner join DT22 on MT22.MT22ID = DT22.MT22ID where MT22.MT22ID = 'dd0366ab-ee97-473a-b175-1f2ec0186a10' and ((MT22.NXT=1 and  isNhap=1))
Error code: 515
Message: Cannot insert the value NULL into column 'TK', table 'CBASGD200.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/19/2021 10:10:53 AM
SqlContent: insert into BLTK(MaCT,NgayCT,SoCT,MTID,MTIDDT,TK,TKDu,PsCo,MaBP,MaVV,MaPhi,MaNT,OngBa,TyGia,DienGiai,MaKH,MaCongtrinh,MaCN,NhomDk) select MT22.MaCT,MT22.NgayCT,MT22.SoCT,MT22.MT22ID,DT22.DT22ID,DT22.TKNo,DT22.TKCp,ps-case when tkck  like '711%' then 0 else ck end,DT22.MaBP,DT22.MaVV,DT22.MaPhi,MT22.MaNT,MT22.OngBa,1,MT22.DienGiai,MT22.MaKH,DT22.MaCongtrinh,MT22.MaCN,'PNMA' from MT22 inner join DT22 on MT22.MT22ID = DT22.MT22ID where MT22.MT22ID = 'dd0366ab-ee97-473a-b175-1f2ec0186a10' and ((MT22.NXT=1 and  isNhap=1))
Error code: 515
Message: Cannot insert the value NULL into column 'TKDu', table 'CBASGD200.dbo.BLTK'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/19/2021 10:29:16 AM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-94d7a18e-6a50-4882-81da-a269967a9658-CONGTY--False-0--03/04/2021 00:00:00-MH21.0002-CONGTY-PNM-Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VN-03/05/2021 00:00:00-345-3453-CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế-0--rưer-VND-1.000000-3311-10-1331-2959962-2959962-295996-295996-3255958-3255958-0-True-0-0-01---0-0-1-7111-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD200", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:30:29 AM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-94d7a18e-6a50-4882-81da-a269967a9658-CONGTY--False-0--03/04/2021 00:00:00-MH21.0002-CONGTY-PNM-Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VN-03/05/2021 00:00:00-345-3453-CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế-0--rưer-VND-1.000000-3311-10-1331-2959962-2959962-295996-295996-3255958-3255958-0-True-0-0-01---0-0-1-7111-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD200", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/19/2021 10:31:57 AM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-94d7a18e-6a50-4882-81da-a269967a9658-CONGTY--False-0--03/04/2021 00:00:00-MH21.0002-CONGTY-PNM-Lô CN1, cụm công nghiệp Tứ Hạ mở rộng, P. Tứ Hạ, TX Hương Trà, tỉnh TT Huế, VN-03/05/2021 00:00:00-345-3453-CTCP Bê Tông thương mại và dịch vụ Thừa Thiên Huế-0--rưer-VND-1.000000-3311-10-1331-2959962-2959962-295996-295996-3255958-3255958-0-True-0-0-01---0-0-1-7111-bd8ce3f6-3a61-4046-b9a2-6be8040fb76c
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_mt22_dmtk". The conflict occurred in database "CBASGD200", table "dbo.DMTK", column 'TK'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/24/2021 10:00:20 AM
SqlContent: select a.*, b.* from sysUser a inner join sysUserGroup b on a.sysUserGroupID=b.sysUserGroupID where UserName = 'SGD' and Password = '20-2C-B9-62-AC-59-07-5B-96-4B-07-15-2D-23-4B-70'
Error code: 208
Message: Invalid object name 'sysUserGroup'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 03/25/2021 3:08:42 PM
SqlContent: DECLARE @TUNGAY DATETIME
DECLARE @DENNGAY DATETIME 

SET @TUNGAY ='04/01/2021 00:00:00' --'01/01/2011 00:00:00'--
SET @DENNGAY ='12/31/2021 00:00:00' --'12/31/2011 00:00:00' --

SELECT *
INTO #TMPBCGC1
FROM
(
--XUAT NGUYEN LIEU VA NHAP THANH PHAM
SELECT 1 AS SORT, A.MT4NID, A.MTGCID, A.MAKH, A.NGAYCT AS NGAYXUAT, A.SOCT, NULL AS NGAYNHAP, B.MAKHO AS KHOXUAT, NULL AS KHONHAP, B.MAVT, D.TENVT, B.MADVT, B.SOLUONG , B.PS AS TIENXUAT, NULL AS TIENNHAP
FROM MT4N A
LEFT JOIN CT4N B ON A.MT4NID=B.MT4NID
LEFT JOIN DMVT D ON B.MAVT=D.MAVT
LEFT JOIN DMKHO F ON B.MAKHO=F.MAKHO
UNION ALL
SELECT 2 AS SORT, A.MT4NID, A.MTGCID, A.MAKH, A.NGAYCT AS NGAYXUAT, A.SOCT, B.NGAYNHAP, NULL AS KHOXUAT, B.MAKHO AS KHONHAP, B.MATP AS MAVT, D.TENVT, D.MADVT, B.SOLUONG, NULL AS TIENXUAT, B.TIEN AS TIENNHAP
FROM MT4N A
INNER JOIN DT4N B ON A.MT4NID=B.MT4NID
LEFT JOIN DMVT D ON B.MATP=D.MAVT
LEFT JOIN DMKHO F ON B.MAKHO=F.MAKHO
)Y

/*
--CHI PHI GIA CONG
SELECT MT4NID, TTIEN FROM MT25 WHERE MT4NID IS NOT NULL
--HOP DONG GIA CONG
SELECT A.NGAYHD, A.SOHD, A.MAKH, C.TENKH, A.GTHD, A.DIENGIAI, B.MAVT AS MATPDAT, D.TENVT AS TENTPDAT, B.MADVT, B.SOLUONG AS SLTPDAT
FROM MTGC A
LEFT JOIN DTGC B ON A.MTGCID=B.MTGCID
LEFT JOIN DMKH C ON A.MAKH=C.MAKH
LEFT JOIN DMVT D ON B.MAVT=D.MAVT

SELECT * FROM #TMPBCGC1
*/

SELECT SOHD, MAKH, TENKH, SOCT, NGAYXUAT, NGAYNHAP, MAVT, TENVT, SOLUONG, TIENXUAT, TIENNHAP,GTHD
FROM (
SELECT 0 AS SORT, A.MT4NID, A.MAKH, D.TENKH, C.SOHD, A.SOCT, A.NGAYXUAT, NULL AS NGAYNHAP, NULL AS MAVT, NULL AS TENVT, NULL AS MADVT, NULL AS SOLUONG, SUM(TIENNHAP) AS TIENNHAP, SUM(TIENXUAT) AS TIENXUAT, C.GTHD
FROM #TMPBCGC1 A
LEFT JOIN MTGC C ON A.MTGCID=C.MTGCID
LEFT JOIN DMKH D ON A.MAKH=D.MAKH
GROUP BY A.MT4NID, A.MAKH, D.TENKH, C.SOHD, A.SOCT, A.NGAYXUAT, C.GTHD

UNION ALL

SELECT SORT, MT4NID, A.MAKH, B.TENKH, NULL AS SOHD, SOCT, NGAYXUAT, NGAYNHAP, MAVT, TENVT, MADVT, SOLUONG, TIENXUAT, TIENNHAP, NULL AS CHIPHI, NULL AS GTHD
FROM #TMPBCGC1 A
LEFT JOIN DMKH B ON A.MAKH=B.MAKH
)X
WHERE (NGAYXUAT BETWEEN @TUNGAY AND @DENNGAY) AND 1 = 1 and MaKH like 'HCM03-021%'
ORDER BY MT4NID, SORT

DROP TABLE #TMPBCGC1

Error code: 207
Message: Invalid column name 'MAVT'.
Invalid column name 'MAVT'.
Invalid column name 'PS'.
Invalid column name 'MATP'.
Invalid column name 'MATP'.
Invalid column name 'TIEN'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 03/26/2021 4:30:43 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='0ec1fdc3-6ff1-4ac6-99db-230151f31255'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
,,
Error code: 102
Message: Incorrect syntax near ','.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 4:36:24 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='bcd70b4d-b961-4f07-bb09-58b5a188bd14'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
,,
Error code: 102
Message: Incorrect syntax near ','.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 4:54:30 PM
SqlContent: insert into MT22(CPNT,CP,MT26ID,TThueCPNT,TThueCP,MT22ID,MaKHThue,sysDBID,HDDV,TienDV,MaDTTax,NgayCT,SoCT,MaKH,MaCT,DiaChi,NgayHd,SoHoaDon,SoSeri,OngBa,Approved,MaNV,DienGiai,MaNT,TyGia,TKCo,MaThueMT,TKThue,TtienHNT,TtienH,TTthueNT,TTthue,TtienCT,TtienCTNT,HanTT,NXT,PrintIndex,SCTGoc,MaCN,KhoNhap,MT42ID,TCK,TCKNT,isNhap,TkCk,TaskID) values(@CPNT,@CP,@MT26ID,@TThueCPNT,@TThueCP,@MT22ID,@MaKHThue,@sysDBID,@HDDV,@TienDV,@MaDTTax,@NgayCT,@SoCT,@MaKH,@MaCT,@DiaChi,@NgayHd,@SoHoaDon,@SoSeri,@OngBa,@Approved,@MaNV,@DienGiai,@MaNT,@TyGia,@TKCo,@MaThueMT,@TKThue,@TtienHNT,@TtienH,@TTthueNT,@TTthue,@TtienCT,@TtienCTNT,@HanTT,@NXT,@PrintIndex,@SCTGoc,@MaCN,@KhoNhap,@MT42ID,@TCK,@TCKNT,@isNhap,@TkCk,@TaskID)-0-0--0-0-f7ad78b7-3fa2-4992-bd65-92edc0045ab5-0401300642--False-0--03/05/2021 00:00:00-MH21.0001-0401300642-PNM-379 Cách Mạng Tháng 8 - Quận Cẩm Lệ - Đà Nẵng-03/02/2021 00:00:00----1--dsfsd-VND-1.000000-331-10-1331-1250000-1250000-125000-125000-1375000-1375000-0-False-0-0-01---0-0-1-7111-4c013df5-ca1d-4de8-905d-027d354b2422
Error code: 2627
Message: Violation of PRIMARY KEY constraint 'PK_MT22'. Cannot insert duplicate key in object 'dbo.MT22'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/26/2021 6:14:13 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='d8d8d1b7-5489-4e7c-9985-0305e84d31d1'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='d8d8d1b7-5489-4e7c-9985-0305e84d31d1'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:16:39 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:20:54 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:22:40 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:24:17 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:24:33 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:26:29 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:30:56 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:33:43 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:35:21 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:37:19 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:40:25 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:40:40 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:40:46 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 6:40:50 PM
SqlContent: DECLARE @CHUATT INT
DECLARE @MT26ID UNIQUEIDENTIFIER
SELECT @MT26ID=MT26ID FROM MT22 WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
SELECT @CHUATT = COUNT (*) FROM 
(
	SELECT A.*, B.DATT FROM 
	(
		SELECT MAVT, SUM(SOLUONG) AS SOLUONG FROM DT26 WHERE MT26ID=@MT26ID
		GROUP BY MAVT) A LEFT JOIN 
	(
		SELECT MAVT, SUM(SOLUONG)AS DATT FROM MT22 A INNER JOIN DT22 B ON A.MT22ID=B.MT22ID WHERE A.MT26ID=@MT26ID
		GROUP BY MAVT
	) B ON A.MAVT=B.MAVT 
) X WHERE SOLUONG>DATT OR DATT IS NULL
DECLARE @ET UNIQUEIDENTIFIER
SET @ET=CDTSGD200.DBO.GETETID('DT26')
IF(@CHUATT=0) UPDATE MT26 SET TASKID=@ET, APPROVED=6 WHERE MT26ID=@MT26ID
UPDATE DMVT SET TONMIN= B.APPROVED FROM MT22 B WHERE MT22ID='e31a3652-d24b-4cf6-aad4-685fd87cddd2'
..
Error code: 102
Message: Incorrect syntax near '.'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/26/2021 7:18:06 PM
SqlContent: delete from DMKho where MaKho = @MaKho-NVL
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_blvt_dmkho". The conflict occurred in database "CBASGD200", table "dbo.BLVT", column 'MaKho'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at Sunday, March 28, 2021
SqlContent: insert into BLTK(MaCT,MTID,NgayCT,SoCT,TK,TKDu,PsCo,PsCoNT,MaVV,MaNT,TyGia,MaKH,OngBa,MTIDDT,DienGiai,MaCN,NhomDk) select MT46.MaCT,MT46.MT46ID,MT46.NgayCT,MT46.SoCT,'1521','6211',CT46.Thanhtien,CT46.Thanhtien,MT46.MaVV,'VND',1,MT46.MaKH,MT46.OngBa,CT46.DT46ID,MT46.DienGiai,MT46.MaCN,'PYC2' from MT46 inner join CT46 on MT46.MT46ID = CT46.MT46ID where MT46.NGAYCT between '3/1/2021 12:00:00 AM' and '12/31/2021 12:00:00 AM'
Error code: 207
Message: Invalid column name 'MT46ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at Sunday, March 28, 2021
SqlContent: insert into BLTK(MaCT,MTID,NgayCT,SoCT,TK,TKDu,PsNo,PsNoNT,MaVV,MaNT,TyGia,MaKH,OngBa,MTIDDT,DienGiai,MaCN,NhomDk) select MT46.MaCT,MT46.MT46ID,MT46.NgayCT,MT46.SoCT,'6211','1521',CT46.Thanhtien,CT46.Thanhtien,MT46.MaVV,'VND',1,MT46.MaKH,MT46.OngBa,CT46.DT46ID,MT46.DienGiai,MT46.MaCN,'PYC1' from MT46 inner join CT46 on MT46.MT46ID = CT46.MT46ID where MT46.NGAYCT between '3/1/2021 12:00:00 AM' and '12/31/2021 12:00:00 AM'
Error code: 207
Message: Invalid column name 'MT46ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/28/2021 5:47:17 PM
SqlContent: delete from DMVT where MaVT = @MaVT-A
Error code: 547
Message: The DELETE statement conflicted with the REFERENCE constraint "fk_dt35_dmvt". The conflict occurred in database "CBASGD200", table "dbo.DT35", column 'MaVT'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/29/2021 8:02:23 PM
SqlContent: insert into VATOUT(NgayCt,NgayHd,Sohoadon,SoSerie,MaKH,DiaChi,DienGiai,TTien,MaThue,TThue,ThueSuat,TKThue,TKDu,MTID,MTIDDT,MaCN,MaDTTax,MaKHThue,NhomDk) select MT31.NgayCT,MT31.NgayHD,MT31.SoHoaDon,MT31.Soseri,DT31.MaKHCt,MT31.DiaChi,DT31.DienGiaiCt,DT31.Ps,DT31.MaThueCt,DT31.Thue,DT31.ThueSuat,MT31.TKThue,MT31.TKNo,MT31.MT31ID,DT31.DT31ID,MT31.MaCN,MT31.MaDTTax,MT31.MaKHThue,'VAT1' from MT31 inner join DT31 on MT31.MT31ID = DT31.MT31ID where MT31.MT31ID = '0b46185a-969f-4951-beb1-38399febb81f'
Error code: 515
Message: Cannot insert the value NULL into column 'NgayHd', table 'CBASGD200.dbo.VATOUT'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 03/30/2021 2:29:35 PM
SqlContent: update DT43 set DT43ID = @DT43ID,MT43ID = @MT43ID,Gia = @Gia,Ps = @Ps,Sl = @Sl,MaCongtrinh = @MaCongtrinh,MaLo = @MaLo,SlTP = @SlTP,SlNhap = @SlNhap,GiaNhap = @GiaNhap,TienNhap = @TienNhap,TK154 = @TK154,TKTP = @TKTP,LoTP = @LoTP,MaSP = @MaSP,MaKho = @MaKho,MaVT = @MaVT,MaDVT = @MaDVT,SoLuong = @SoLuong,GiaNT = @GiaNT,PsNT = @PsNT,TkCo = @TkCo,TkNo = @TkNo,MaBP = @MaBP,MaPhi = @MaPhi,GhiChu = @GhiChu,MaVV = @MaVV,MaHD = @MaHD where DT43ID = @DT43ID-bdcfdbd5-c744-42b1-a864-f06ee7af1b8c-9a2d9276-b5af-41e4-8c59-606a0d86cd9d-5000.000000-5000.000000-0.000000---0.000000-0.000000-0.000000-0.000000-----TP1-NVL1-KG-1.000000-5000.000000-5000.000000-1521-6211-----
Error code: 547
Message: The UPDATE statement conflicted with the FOREIGN KEY constraint "fk_dt43_dmkho". The conflict occurred in database "CBASGD200", table "dbo.DMKho", column 'MaKho'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/30/2021 2:29:51 PM
SqlContent: update DT43 set DT43ID = @DT43ID,MT43ID = @MT43ID,Gia = @Gia,Ps = @Ps,Sl = @Sl,MaCongtrinh = @MaCongtrinh,MaLo = @MaLo,SlTP = @SlTP,SlNhap = @SlNhap,GiaNhap = @GiaNhap,TienNhap = @TienNhap,TK154 = @TK154,TKTP = @TKTP,LoTP = @LoTP,MaSP = @MaSP,MaKho = @MaKho,MaVT = @MaVT,MaDVT = @MaDVT,SoLuong = @SoLuong,GiaNT = @GiaNT,PsNT = @PsNT,TkCo = @TkCo,TkNo = @TkNo,MaBP = @MaBP,MaPhi = @MaPhi,GhiChu = @GhiChu,MaVV = @MaVV,MaHD = @MaHD where DT43ID = @DT43ID-bdcfdbd5-c744-42b1-a864-f06ee7af1b8c-9a2d9276-b5af-41e4-8c59-606a0d86cd9d-5000.000000-5000.000000-0.000000---0.000000-0.000000-0.000000-0.000000-----TP1-NVL1-KG-1.000000-5000.000000-5000.000000-1521-6211-----
Error code: 547
Message: The UPDATE statement conflicted with the FOREIGN KEY constraint "fk_dt43_dmkho". The conflict occurred in database "CBASGD200", table "dbo.DMKho", column 'MaKho'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/30/2021 4:30:10 PM
SqlContent: insert into DT4G(SlTP,LoTP,Sl,MaCongtrinh,DT4GID,MT4GID,Gia,Ps,MaKho,MaVT,MaDVT,SoLuong,GiaNT,PsNT,MaLo,MaSP,SlNhap,TienNhap,GiaNhap,TkCo,TkNo,TK154,TKTP,MaBP,MaPhi,GhiChu,MaVV,MaHD) values(@SlTP,@LoTP,@Sl,@MaCongtrinh,@DT4GID,@MT4GID,@Gia,@Ps,@MaKho,@MaVT,@MaDVT,@SoLuong,@GiaNT,@PsNT,@MaLo,@MaSP,@SlNhap,@TienNhap,@GiaNhap,@TkCo,@TkNo,@TK154,@TKTP,@MaBP,@MaPhi,@GhiChu,@MaVV,@MaHD)-0--0--9563f80e-bdd9-4c84-922e-6975438c113d-1e159840-55ec-48d5-aadb-2a156040d5f7-50000-50000000-NVL-IPHONEX-CAI-1000-50000-50000000-01BTTP--0-0-0-1561-154-------
Error code: 515
Message: Cannot insert the value NULL into column 'MaSP', table 'CBASGD200.dbo.DT4G'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/30/2021 4:30:16 PM
SqlContent: insert into DT4G(SlTP,LoTP,Sl,MaCongtrinh,DT4GID,MT4GID,Gia,Ps,MaKho,MaVT,MaDVT,SoLuong,GiaNT,PsNT,MaLo,MaSP,SlNhap,TienNhap,GiaNhap,TkCo,TkNo,TK154,TKTP,MaBP,MaPhi,GhiChu,MaVV,MaHD) values(@SlTP,@LoTP,@Sl,@MaCongtrinh,@DT4GID,@MT4GID,@Gia,@Ps,@MaKho,@MaVT,@MaDVT,@SoLuong,@GiaNT,@PsNT,@MaLo,@MaSP,@SlNhap,@TienNhap,@GiaNhap,@TkCo,@TkNo,@TK154,@TKTP,@MaBP,@MaPhi,@GhiChu,@MaVV,@MaHD)-0--0--9563f80e-bdd9-4c84-922e-6975438c113d-1e159840-55ec-48d5-aadb-2a156040d5f7-50000-50000000-NVL-IPHONEX-CAI-1000-50000-50000000-01BTTP--0-0-0-1561-154-------
Error code: 515
Message: Cannot insert the value NULL into column 'MaSP', table 'CBASGD200.dbo.DT4G'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/30/2021 4:30:45 PM
SqlContent: insert into DT4G(SlTP,LoTP,Sl,MaCongtrinh,DT4GID,MT4GID,Gia,Ps,MaKho,MaVT,MaDVT,SoLuong,GiaNT,PsNT,MaLo,MaSP,SlNhap,TienNhap,GiaNhap,TkCo,TkNo,TK154,TKTP,MaBP,MaPhi,GhiChu,MaVV,MaHD) values(@SlTP,@LoTP,@Sl,@MaCongtrinh,@DT4GID,@MT4GID,@Gia,@Ps,@MaKho,@MaVT,@MaDVT,@SoLuong,@GiaNT,@PsNT,@MaLo,@MaSP,@SlNhap,@TienNhap,@GiaNhap,@TkCo,@TkNo,@TK154,@TKTP,@MaBP,@MaPhi,@GhiChu,@MaVV,@MaHD)-0--0--9563f80e-bdd9-4c84-922e-6975438c113d-1e159840-55ec-48d5-aadb-2a156040d5f7-50000-50000000-NVL-IPHONEX-CAI-1000-50000-50000000-01BTTP-TP1-0-0-0-1561-154--155-----
Error code: 515
Message: Cannot insert the value NULL into column 'TK154', table 'CBASGD200.dbo.DT4G'; column does not allow nulls. INSERT fails.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateData(String sql, String[] paraNames, Object[] paraValues, SqlDbType[] paraTypes) in D:\SGDPV\CDTDatabase\Database.cs:line 867
-------------------------------
 Log at 03/31/2021 2:06:49 PM
SqlContent: SELECT FR.STT, FR.CHITIEU,TK,TKDU, FR.MASO, FR.THUYETMINH, FR.CHITIEU2, FR.CACHTINH, FR.LOAICT, FR.INBAOCAO
	,999999999999999.0  AS KYTRUOC
	,999999999999999.0 AS KYNAY
	INTO T
	FROM SYSFORMREPORT FR
	WHERE FR.SYSREPORTID = 145 -- 145
	ORDER BY STT

DECLARE @NGAYCT1 DATETIME
DECLARE @NGAYCT2 DATETIME
DECLARE @NGAYCT3 DATETIME
DECLARE @NGAYCT4 DATETIME
	SET @NGAYCT1='01/01/2021 00:00:00'--'03/01/2008'
	--SET @NGAYCT1= DATEADD(DAY,-1,@NGAYCT1)
	SET @NGAYCT2='12/31/2021 00:00:00'--'01/01/2009'
	SET @NGAYCT3='01/01/2021 00:00:00'--'01/01/2008'
	--SET @NGAYCT3= DATEADD(DAY,-1,@NGAYCT3)
	SET @NGAYCT4='12/31/2021 00:00:00'
DECLARE CUR CURSOR FOR SELECT MASO,LOAICT,TK,TKDU,KYTRUOC,KYNAY FROM T
	OPEN CUR
DECLARE @MASO NVARCHAR (50)
DECLARE @LOAICT INT
DECLARE @TK NVARCHAR (2560)
DECLARE @TKDU NVARCHAR (2560)
DECLARE @KYTRUOC FLOAT
DECLARE @KYNAY FLOAT
--TÍNH CÁC CH? TIÊU
DECLARE @PSNO FLOAT
DECLARE @PSCO FLOAT
DECLARE @NODAU FLOAT
DECLARE @CODAU FLOAT
DECLARE @NGAYCTDAU DATETIME
FETCH CUR  INTO @MASO,@LOAICT,@TK,@TKDU,@KYTRUOC,@KYNAY
WHILE @@FETCH_STATUS=0
BEGIN
	--LAY SO PHAT SINH KY TRUOC
	IF @TK IS NOT NULL AND @LOAICT<>0 AND @LOAICT<>1
	BEGIN
		IF @TKDU IS NOT NULL 
		BEGIN		
			SET @TKDU=' TKDU LIKE''' +REPLACE(@TKDU,',','%'' OR TKDU LIKE''') + '%''' 
			EXEC SOPSTAIKHOAN @TK, @NGAYCT3,@NGAYCT4,@TKDU , @PSNO OUTPUT , @PSCO OUTPUT 
		END
		ELSE 
		BEGIN
			EXEC SOPSTAIKHOAN @TK, @NGAYCT3,@NGAYCT4, DEFAULT, @PSNO OUTPUT , @PSCO OUTPUT 
		END
		IF @LOAICT=3 SET @KYTRUOC=-@PSNO
		IF @LOAICT=4 SET @KYTRUOC=@PSCO

		--L?Y S? CU?I K?
		IF @TKDU IS NOT NULL 
		BEGIN					
			EXEC SOPSTAIKHOAN @TK, @NGAYCT1,@NGAYCT2,@TKDU , @PSNO OUTPUT , @PSCO OUTPUT 
		END
		ELSE
		BEGIN
	 		EXEC SOPSTAIKHOAN @TK, @NGAYCT1,@NGAYCT2, DEFAULT, @PSNO OUTPUT , @PSCO OUTPUT 
		END
		IF @LOAICT=3 SET @KYNAY=-@PSNO
		IF @LOAICT=4 SET @KYNAY=@PSCO
		UPDATE T SET KYTRUOC=@KYTRUOC WHERE MASO=@MASO
		UPDATE T SET KYNAY=@KYNAY WHERE MASO=@MASO
	
	END
	IF @LOAICT=1 
	BEGIN
		SET @NGAYCTDAU=DATEADD(DAY,-1,@NGAYCT1)
		EXEC SODUTAIKHOAN @TK, @NGAYCTDAU, DEFAULT,@NODAU OUTPUT, @CODAU OUTPUT
		UPDATE T SET KYNAY=@NODAU WHERE MASO=@MASO
		SET @NGAYCTDAU=DATEADD(DAY,-1,@NGAYCT3)
		EXEC SODUTAIKHOAN @TK, @NGAYCTDAU, DEFAULT,@NODAU OUTPUT, @CODAU OUTPUT
		UPDATE T SET KYTRUOC=@NODAU WHERE MASO=@MASO
	END
	FETCH CUR  INTO @MASO,@LOAICT,@TK,@TKDU,@KYTRUOC,@KYNAY
END
CLOSE CUR
DEALLOCATE CUR
UPDATE T SET KYTRUOC=0,KYNAY=0 WHERE LOAICT=0
SELECT STT, FR.CHITIEU,TK,TKDU, MASO, 
	, KYTRUOC
	, KYNAY,THUYETMINH, CHITIEU2, CACHTINH, LOAICT, INBAOCAO
 FROM T
DROP TABLE T

Error code: 102
Message: Incorrect syntax near ','.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 04/01/2021 6:52:55 PM
SqlContent: SELECT MACT,MTID, SOCT, NGAYCT, DIENGIAI, TK, SUM(PSNO) AS PSNO, SUM(PSCO) AS PSCO
FROM BLTK
WHERE 1 = 1 and NgayCT >= '01/01/0001 00:00:00' and NgayCT <= '01/01/0001 00:00:00'
GROUP BY MACT,MTID,SOCT,NGAYCT,DIENGIAI,TK
ORDER BY NGAYCT, SOCT

Error code: 296
Message: The conversion of char data type to smalldatetime data type resulted in an out-of-range smalldatetime value.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at System.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at System.Data.SqlClient.SqlDataReader.Read()
   at System.Data.Common.DataAdapter.FillLoadDataRow(SchemaMapping mapping)
   at System.Data.Common.DataAdapter.FillFromReader(DataSet dataset, DataTable datatable, String srcTable, DataReaderContainer dataReader, Int32 startRecord, Int32 maxRecords, DataColumn parentChapterColumn, Object parentChapterValue)
   at System.Data.Common.DataAdapter.Fill(DataTable[] dataTables, IDataReader dataReader, Int32 startRecord, Int32 maxRecords)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 04/03/2021 4:33:59 PM
SqlContent: delete from BLVT where MTID = '8522f959-6c24-4c5e-8ddd-8b4606cb9ab6' and NhomDk = 'PNH1'
Error code: 1205
Message: Transaction (Process ID 128) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/06/2021 5:53:40 PM
SqlContent:  insert into bltk(mact,mtid,Mtiddt,soct,ngayct,diengiai,makh,tk,tkdu,psno,psco,psnont,pscont,nhomdk,mavv,maphi,ongba,mant,tygia,macongtrinh) values('PBCT','ea027130-7d78-4543-8bb7-de2ef16ee9de','605e591d-2866-402f-88a5-8a6d8bd3cf7e','PBCT/12','12/31/2020',N'Phân bổ chi phí cho công trình','CONGTY','6272','154',0,1455593,0,1455593,'PBCT1',null,'',N'Bút toán phân bổ tự động','VND',1,'0207BD1')
Error code: 547
Message: The INSERT statement conflicted with the FOREIGN KEY constraint "fk_bltk_dmphi". The conflict occurred in database "CBA0316260357TNPHAT", table "dbo.DMPhi", column 'MaPhi'.
The statement has been terminated.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.insertRow(String tableName, List`1 fieldName, List`1 values) in D:\SGDPV\CDTDatabase\Database.cs:line 923
-------------------------------
 Log at 04/12/2021 12:25:41 PM
SqlContent: ALTER TABLE DT35 ADD  TonKho decimal(20,6)
Error code: 2705
Message: Column names in each table must be unique. Column name 'TonKho' in table 'DT35' is specified more than once.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/13/2021 2:24:54 PM
SqlContent: DECLARE	@RETURN_VALUE INT,
		@SOCT UNIQUEIDENTIFIER

EXEC	 [DBO].[GETBTID]
		@TBNAME = N'DT12',
		@SOCT = @SOCT OUTPUT
		--PRINT @SOCT
		--UPDATE MT22 SET TASKID='BD8CE3F6-3A61-4046-B9A2-6BE8040FB76C'

DECLARE @MT22ID UNIQUEIDENTIFIER
SET @MT22ID=--'b67ca2e9-935e-434a-ad0a-ef28dbc5e948'--'D8CA02C2-51EE-41B5-94EE-DFF9A958F1C7'
DELETE BLTK WHERE MTID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID) AND MACT='PC'
DELETE DT12 WHERE MT12ID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID)
DELETE MT12 WHERE MT22ID=@MT22ID
DECLARE @MT12ID UNIQUEIDENTIFIER
SET @MT12ID=NEWID()
DECLARE @SOCT1 NVARCHAR(128)

SET @SOCT1='PC0000'
INSERT INTO MT12 (MT12ID,NGAYCT, MACT, SOCT, MAKH, DIACHI, ONGBA,DIENGIAI, MANT, TYGIA, TKCO, TTIENNT, TTIEN,TKTHUE, TTTHUE, TTIENCT, MATHUEMT,PRINTINDEX, SCTGOC, MT22ID, TASKID)
SELECT @MT12ID, NGAYCT, 'PC', @SOCT1, MAKH, CASE WHEN DIACHI IS NULL THEN '' ELSE DIACHI END,CASE WHEN ONGBA IS NULL THEN '' ELSE ONGBA END, N'CHI TIỀN MUA DỊCH VỤ THEO PHIẾU NHẬP SỐ ' + SOCT,
 MANT, TYGIA, '1111',TTIENH+TTTHUE, TTIENH+TTTHUE,TKTHUE,0,TTIENH+TTTHUE, MATHUEMT,0,0,MT22ID,@SOCT FROM MT21 WHERE MT21ID=@MT22ID

INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
SELECT @MT12ID, NEWID(), A.DIENGIAI,A.MAKH, TTIENCTNT, TTIENCT, TKCO, A.MT22ID 
	FROM MT21 A  WHERE A.MT21ID=@MT22ID 

	
--INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
--SELECT @MT12ID, NEWID(),N' THUẾ GIÁ TRỊ GIA TĂNG', MAKH,TTTHUE,TTTHUE,TKTHUE, MT22ID FROM MT22  WHERE MT22ID=@MT22ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSNO,MAPHI,MAVV,PSNONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK)
 SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,DT12.MAKHCT,DT12.TKNO,MT12.TKCO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC11' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSCO,MAPHI,MAVV,PSCONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK) 
SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,MT12.MAKH,MT12.TKCO,DT12.TKNO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC12' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID


Error code: 156
Message: Incorrect syntax near the keyword 'DELETE'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/13/2021 2:26:02 PM
SqlContent: DECLARE	@RETURN_VALUE INT,
		@SOCT UNIQUEIDENTIFIER

EXEC	 [DBO].[GETBTID]
		@TBNAME = N'DT12',
		@SOCT = @SOCT OUTPUT
		--PRINT @SOCT
		--UPDATE MT22 SET TASKID='BD8CE3F6-3A61-4046-B9A2-6BE8040FB76C'

DECLARE @MT22ID UNIQUEIDENTIFIER
SET @MT22ID='b67ca2e9-935e-434a-ad0a-ef28dbc5e948'--'D8CA02C2-51EE-41B5-94EE-DFF9A958F1C7'--
DELETE BLTK WHERE MTID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID) AND MACT='PC'
DELETE DT12 WHERE MT12ID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID)
DELETE MT12 WHERE MT22ID=@MT22ID
DECLARE @MT12ID UNIQUEIDENTIFIER
SET @MT12ID=NEWID()
DECLARE @SOCT1 NVARCHAR(128)

SET @SOCT1='PC0000'
INSERT INTO MT12 (MT12ID,NGAYCT, MACT, SOCT, MAKH, DIACHI, ONGBA,DIENGIAI, MANT, TYGIA, TKCO, TTIENNT, TTIEN,TKTHUE, TTTHUE, TTIENCT, MATHUEMT,PRINTINDEX, SCTGOC, MT22ID, TASKID)
SELECT @MT12ID, NGAYCT, 'PC', @SOCT1, MAKH, CASE WHEN DIACHI IS NULL THEN '' ELSE DIACHI END,CASE WHEN ONGBA IS NULL THEN '' ELSE ONGBA END, N'CHI TIỀN MUA DỊCH VỤ THEO PHIẾU NHẬP SỐ ' + SOCT,
 MANT, TYGIA, '1111',TTIENH+TTTHUE, TTIENH+TTTHUE,TKTHUE,0,TTIENH+TTTHUE, MATHUEMT,0,0,MT22ID,@SOCT FROM MT21 WHERE MT21ID=@MT22ID

INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
SELECT @MT12ID, NEWID(), A.DIENGIAI,A.MAKH, TTIENCTNT, TTIENCT, TKCO, A.MT22ID 
	FROM MT21 A  WHERE A.MT21ID=@MT22ID 

	
--INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
--SELECT @MT12ID, NEWID(),N' THUẾ GIÁ TRỊ GIA TĂNG', MAKH,TTTHUE,TTTHUE,TKTHUE, MT22ID FROM MT22  WHERE MT22ID=@MT22ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSNO,MAPHI,MAVV,PSNONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK)
 SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,DT12.MAKHCT,DT12.TKNO,MT12.TKCO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC11' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSCO,MAPHI,MAVV,PSCONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK) 
SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,MT12.MAKH,MT12.TKCO,DT12.TKNO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC12' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID


Error code: 207
Message: Invalid column name 'TTTHUE'.
Invalid column name 'TTTHUE'.
Invalid column name 'TTTHUE'.
Invalid column name 'MATHUEMT'.
Invalid column name 'MT22ID'.
Invalid column name 'TTIENCTNT'.
Invalid column name 'TTIENCT'.
Invalid column name 'MT22ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/13/2021 2:27:42 PM
SqlContent: DECLARE	@RETURN_VALUE INT,
		@SOCT UNIQUEIDENTIFIER

EXEC	 [DBO].[GETBTID]
		@TBNAME = N'DT12',
		@SOCT = @SOCT OUTPUT
		--PRINT @SOCT
		--UPDATE MT22 SET TASKID='BD8CE3F6-3A61-4046-B9A2-6BE8040FB76C'

DECLARE @MT22ID UNIQUEIDENTIFIER
SET @MT22ID='33b6472e-46c9-4d97-8fd0-f6f771357b27'--'D8CA02C2-51EE-41B5-94EE-DFF9A958F1C7'--
DELETE BLTK WHERE MTID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID) AND MACT='PC'
DELETE DT12 WHERE MT12ID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID)
DELETE MT12 WHERE MT22ID=@MT22ID
DECLARE @MT12ID UNIQUEIDENTIFIER
SET @MT12ID=NEWID()
DECLARE @SOCT1 NVARCHAR(128)

SET @SOCT1='PC0000'
INSERT INTO MT12 (MT12ID,NGAYCT, MACT, SOCT, MAKH, DIACHI, ONGBA,DIENGIAI, MANT, TYGIA, TKCO, TTIENNT, TTIEN,TKTHUE, TTTHUE, TTIENCT, MATHUEMT,PRINTINDEX, SCTGOC, MT22ID, TASKID)
SELECT @MT12ID, NGAYCT, 'PC', @SOCT1, MAKH, CASE WHEN DIACHI IS NULL THEN '' ELSE DIACHI END,CASE WHEN ONGBA IS NULL THEN '' ELSE ONGBA END, N'CHI TIỀN MUA DỊCH VỤ THEO PHIẾU NHẬP SỐ ' + SOCT,
 MANT, TYGIA, '1111',TTIENH+TTHUE, TTIENH+TTHUE,TKTHUE,0,TTIENH+TTHUE, MATHUEMT,0,0,MT22ID,@SOCT FROM MT21 WHERE MT21ID=@MT22ID

INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
SELECT @MT12ID, NEWID(), A.DIENGIAI,A.MAKH, TTIENCTNT, TTIENCT, TKCO, A.MT22ID 
	FROM MT21 A  WHERE A.MT21ID=@MT22ID 

	
--INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
--SELECT @MT12ID, NEWID(),N' THUẾ GIÁ TRỊ GIA TĂNG', MAKH,TTTHUE,TTTHUE,TKTHUE, MT22ID FROM MT22  WHERE MT22ID=@MT22ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSNO,MAPHI,MAVV,PSNONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK)
 SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,DT12.MAKHCT,DT12.TKNO,MT12.TKCO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC11' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSCO,MAPHI,MAVV,PSCONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK) 
SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,MT12.MAKH,MT12.TKCO,DT12.TKNO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC12' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID


Error code: 207
Message: Invalid column name 'MATHUEMT'.
Invalid column name 'MT22ID'.
Invalid column name 'TTIENCTNT'.
Invalid column name 'TTIENCT'.
Invalid column name 'MT22ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/13/2021 2:32:38 PM
SqlContent: DECLARE	@RETURN_VALUE INT,
		@SOCT UNIQUEIDENTIFIER

EXEC	 [DBO].[GETBTID]
		@TBNAME = N'DT12',
		@SOCT = @SOCT OUTPUT
		--PRINT @SOCT
		--UPDATE MT22 SET TASKID='BD8CE3F6-3A61-4046-B9A2-6BE8040FB76C'

DECLARE @MT22ID UNIQUEIDENTIFIER
SET @MT22ID='b67ca2e9-935e-434a-ad0a-ef28dbc5e948'--'D8CA02C2-51EE-41B5-94EE-DFF9A958F1C7'--
DELETE BLTK WHERE MTID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID) AND MACT='PC'
DELETE DT12 WHERE MT12ID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID)
DELETE MT12 WHERE MT22ID=@MT22ID
DECLARE @MT12ID UNIQUEIDENTIFIER
SET @MT12ID=NEWID()
DECLARE @SOCT1 NVARCHAR(128)

SET @SOCT1='PC0000'
INSERT INTO MT12 (MT12ID,NGAYCT, MACT, SOCT, MAKH, DIACHI, ONGBA,DIENGIAI, MANT, TYGIA, TKCO, TTIENNT, TTIEN,TKTHUE, TTTHUE, TTIENCT, MATHUEMT,PRINTINDEX, SCTGOC, MT22ID, TASKID)
SELECT @MT12ID, NGAYCT, 'PC', @SOCT1, MAKH, CASE WHEN DIACHI IS NULL THEN '' ELSE DIACHI END,CASE WHEN ONGBA IS NULL THEN '' ELSE ONGBA END, N'CHI TIỀN MUA DỊCH VỤ THEO PHIẾU NHẬP SỐ ' + SOCT,
 MANT, TYGIA, '1111',TTIENH+TTHUE, TTIENH+TTHUE,TKTHUE,0,TTIENH+TTHUE, MATHUE,0,0,MT22ID,@SOCT FROM MT21 WHERE MT21ID=@MT22ID

INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
SELECT @MT12ID, NEWID(), A.DIENGIAI,A.MAKH, TTIENNT, TTIEN, TKCO, A.MT22ID 
	FROM MT21 A  WHERE A.MT21ID=@MT22ID 

	
--INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
--SELECT @MT12ID, NEWID(),N' THUẾ GIÁ TRỊ GIA TĂNG', MAKH,TTTHUE,TTTHUE,TKTHUE, MT22ID FROM MT22  WHERE MT22ID=@MT22ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSNO,MAPHI,MAVV,PSNONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK)
 SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,DT12.MAKHCT,DT12.TKNO,MT12.TKCO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC11' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSCO,MAPHI,MAVV,PSCONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK) 
SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,MT12.MAKH,MT12.TKCO,DT12.TKNO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC12' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID


Error code: 207
Message: Invalid column name 'MT22ID'.
Invalid column name 'MT22ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/13/2021 2:33:10 PM
SqlContent: DECLARE	@RETURN_VALUE INT,
		@SOCT UNIQUEIDENTIFIER

EXEC	 [DBO].[GETBTID]
		@TBNAME = N'DT12',
		@SOCT = @SOCT OUTPUT
		--PRINT @SOCT
		--UPDATE MT22 SET TASKID='BD8CE3F6-3A61-4046-B9A2-6BE8040FB76C'

DECLARE @MT22ID UNIQUEIDENTIFIER
SET @MT22ID='33b6472e-46c9-4d97-8fd0-f6f771357b27'--'D8CA02C2-51EE-41B5-94EE-DFF9A958F1C7'--
DELETE BLTK WHERE MTID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID) AND MACT='PC'
DELETE DT12 WHERE MT12ID IN (SELECT MT12ID FROM MT12 WHERE MT22ID=@MT22ID)
DELETE MT12 WHERE MT22ID=@MT22ID
DECLARE @MT12ID UNIQUEIDENTIFIER
SET @MT12ID=NEWID()
DECLARE @SOCT1 NVARCHAR(128)

SET @SOCT1='PC0000'
INSERT INTO MT12 (MT12ID,NGAYCT, MACT, SOCT, MAKH, DIACHI, ONGBA,DIENGIAI, MANT, TYGIA, TKCO, TTIENNT, TTIEN,TKTHUE, TTTHUE, TTIENCT, MATHUEMT,PRINTINDEX, SCTGOC, MT22ID, TASKID)
SELECT @MT12ID, NGAYCT, 'PC', @SOCT1, MAKH, CASE WHEN DIACHI IS NULL THEN '' ELSE DIACHI END,CASE WHEN ONGBA IS NULL THEN '' ELSE ONGBA END, N'CHI TIỀN MUA DỊCH VỤ THEO PHIẾU NHẬP SỐ ' + SOCT,
 MANT, TYGIA, '1111',TTIENH+TTHUE, TTIENH+TTHUE,TKTHUE,0,TTIENH+TTHUE, MATHUE,0,0,MT22ID,@SOCT FROM MT21 WHERE MT21ID=@MT22ID

INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
SELECT @MT12ID, NEWID(), A.DIENGIAI,A.MAKH, TTIENNT, TTIEN, TKCO, A.MT21ID 
	FROM MT21 A  WHERE A.MT21ID=@MT22ID 

	
--INSERT INTO DT12(MT12ID, DT12ID, DIENGIAICT, MAKHCT, PSNT, PS, TKNO, MT22ID)
--SELECT @MT12ID, NEWID(),N' THUẾ GIÁ TRỊ GIA TĂNG', MAKH,TTTHUE,TTTHUE,TKTHUE, MT22ID FROM MT22  WHERE MT22ID=@MT22ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSNO,MAPHI,MAVV,PSNONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK)
 SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,DT12.MAKHCT,DT12.TKNO,MT12.TKCO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC11' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID
INSERT INTO BLTK(MACT,MTID,SOCT,NGAYCT,DIENGIAI,MAKH,TK,TKDU,PSCO,MAPHI,MAVV,PSCONT,MANT,ONGBA,MABP,TYGIA,MTIDDT,MASP,MAHD,MACONGTRINH,NHOMDK) 
SELECT MT12.MACT,MT12.MT12ID,MT12.SOCT,MT12.NGAYCT,DT12.DIENGIAICT,MT12.MAKH,MT12.TKCO,DT12.TKNO,DT12.PS,DT12.MAPHI,DT12.MAVV,DT12.PSNT,MT12.MANT,MT12.ONGBA,DT12.MABP,MT12.TYGIA,DT12.DT12ID,DT12.MASP,DT12.MAHD,DT12.MACONGTRINH,'PC12' FROM MT12 INNER JOIN DT12 ON MT12.MT12ID = DT12.MT12ID WHERE MT12.MT12ID = @MT12ID


Error code: 207
Message: Invalid column name 'MT22ID'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/14/2021 1:13:55 PM
SqlContent: select top 50  0 as HasComment,* from MT35 where 1=1  and (TaskID is null  or (TaskID='201d5a4e-599b-41f8-bba7-25df08f9df09') or (TaskID='88033e59-4ac4-4961-976a-52dc1c4aafae') or (TaskID='7ef6b523-b562-4740-8401-54e2d72d014c') or (TaskID='443ca3fd-6093-4c7c-9919-ca9b592479eb') or (TaskID='e15f14ea-0abd-4045-ab81-d3881016c69f') or (TaskID='d4f16021-dd18-4d14-93bf-e2e75f26c2d0')) order by Ngayct desc ,SoCt desc
Error code: 0
Message: A severe error occurred on the current command.  The results, if any, should be discarded.
A severe error occurred on the current command.  The results, if any, should be discarded.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at System.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at System.Data.SqlClient.SqlDataReader.Read()
   at System.Data.Common.DataAdapter.FillLoadDataRow(SchemaMapping mapping)
   at System.Data.Common.DataAdapter.FillFromReader(DataSet dataset, DataTable datatable, String srcTable, DataReaderContainer dataReader, Int32 startRecord, Int32 maxRecords, DataColumn parentChapterColumn, Object parentChapterValue)
   at System.Data.Common.DataAdapter.Fill(DataTable[] dataTables, IDataReader dataReader, Int32 startRecord, Int32 maxRecords)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataSetMasterDetail(String queryMaster, String queryDetail) in D:\SGDPV\CDTDatabase\Database.cs:line 195
-------------------------------
 Log at 04/15/2021 4:01:18 PM
SqlContent: DECLARE @SQL NVARCHAR (4000)
	
	--PHẦN CÂN ĐỐI TK THƯỜNG
SELECT * INTO #WTHUONG FROM ( 
	SELECT MAKHO,MAVT,0.0 AS SLDK,0.0 AS NODAU,SUM(SOLUONG) AS SLN, SUM(SOLUONG_X) AS SLX,SUM(PSNO) AS PSNO,SUM(PSCO) AS PSCO 
	FROM BLVT WITH(NOLOCK) WHERE NGAYCT <=  '04/30/2021 00:00:00' GROUP BY MAVT,MAKHO
	UNION
	SELECT MAKHO,MAVT,SUM(SOLUONG) AS SLDK,SUM(DUDAU) AS NODAU,0.0 AS SLN,0.0 AS SLX,0.0 AS PSNO,0.0 AS PSCO 
	FROM OBVT  WITH(NOLOCK)   GROUP BY MAVT,MAKHO)X

SELECT * INTO #WTHUONG1 FROM (
	SELECT MAKHO,MAVT,SUM(SLDK) AS SLDK, SUM(NODAU) AS DUDAU, SUM(SLN) AS SLN,SUM(SLX) AS SLX, SUM(PSNO) AS PSNO, SUM(PSCO) AS PSCO 
	FROM #WTHUONG GROUP BY MAVT,MAKHO)X
SELECT * INTO #WTHUONG2 FROM (
	SELECT MAKHO, MAVT,SLDK,  DUDAU, SLN,SLX, PSNO,  PSCO, SLDK+SLN-SLX AS SLCK,   DUCUOI = DUDAU+PSNO-PSCO  FROM #WTHUONG1 )X

	
 SELECT A.MAKHO,A.MAVT, DMVT.TENVT, DMDVT.TENDVT, SLCK AS TONCUOI
 INTO #TMPBCTNKHO
 FROM #WTHUONG2 A, DMVT, DMDVT
 WHERE A.MAVT = DMVT.MAVT AND DMVT.MADVT = DMDVT.MADVT
	
SELECT MAVT,TENVT,TENDVT,SUM(KBD) AS KBD,SUM(KBD_H) AS KBD_H,SUM(KTB) AS KTB,SUM(KTB_H) AS KTB_H, SUM(TANSANH01) AS TANSANH01, SUM(THANHCONG) AS THANHCONG, SUM(KNCC) AS KNCC,SUM(KHC) AS KHC,
	SUM(KG) AS KG,SUM(KTC) AS KTC, SUM(KBIG) AS KBIG, SUM(KSTH) AS KSTH,SUM(KAP) AS KAP,SUM(KCTHO) AS KCTHO,SUM(KHCTHO) AS KHCTHO,
	SUM(KTCBH) AS KTCBH, SUM(KVAUMY) AS KVAUMY, SUM(KMINHKHAI) AS KMINHKHAI, SUM(KAP_HGK) AS KAP_HGK, SUM(KMINHKHAI_HGK) AS KMINHKHAI_HGK,
	SUM(KDN) AS KHODANANG,SUM(KHN) AS KHOHANOI, SUM(KSCB) AS KSCB, SUM(KSCB02) AS KSCB02, SUM(HOAPHAT) AS HOAPHAT, SUM(KHO550) AS KHO550, SUM(KHOHBT) AS KHOHBT
FROM (
	SELECT MAVT, TENVT,TENDVT, KBD = CASE WHEN MAKHO = 'KBD' THEN TONCUOI ELSE 0 END, KBD_H = CASE WHEN MAKHO = 'KBD_H' THEN TONCUOI ELSE 0 END,
		 KTB = CASE WHEN MAKHO = 'KTB' THEN TONCUOI ELSE 0 END, KTB_H = CASE WHEN MAKHO = 'KTB_H' THEN TONCUOI ELSE 0 END, 
		 TANSANH01 = CASE WHEN MAKHO = 'TANSANH01' THEN TONCUOI ELSE 0 END,
		 THANHCONG = CASE WHEN MAKHO = 'THANHCONG' THEN TONCUOI ELSE 0 END,
		 KNCC = CASE WHEN MAKHO = 'NCC' THEN TONCUOI ELSE 0 END, KHC = CASE WHEN MAKHO = 'KHC' THEN TONCUOI ELSE 0 END,
		 KG = CASE WHEN MAKHO = 'KG' THEN TONCUOI ELSE 0 END,KTC = CASE WHEN MAKHO = 'KTC' THEN TONCUOI ELSE 0 END,
		 KBIG=CASE WHEN MAKHO = 'KBIG' THEN TONCUOI ELSE 0 END,KSTH=CASE WHEN MAKHO = 'KSTH' THEN TONCUOI ELSE 0 END,
		 KAP=CASE WHEN MAKHO = 'KAP' THEN TONCUOI ELSE 0 END,KCTHO=CASE WHEN MAKHO = 'KCTHO' THEN TONCUOI ELSE 0 END,
		 KHCTHO=CASE WHEN MAKHO = 'KHCTHO' THEN TONCUOI ELSE 0 END,
		KTCBH=CASE WHEN MAKHO = 'KTCBH' THEN TONCUOI ELSE 0 END,
		KVAUMY=CASE WHEN MAKHO = 'KVAUMY' THEN TONCUOI ELSE 0 END,
		KMINHKHAI=CASE WHEN MAKHO = 'KMINHKHAI' THEN TONCUOI ELSE 0 END,
		KAP_HGK=CASE WHEN MAKHO = 'KAP_HGK' THEN TONCUOI ELSE 0 END,
        KMINHKHAI_HGK=CASE WHEN MAKHO = 'KMINHKHAI_HGK' THEN TONCUOI ELSE 0 END,
	    KDN=CASE WHEN MAKHO = 'KDN' THEN TONCUOI ELSE 0 END,
        KHN=CASE WHEN MAKHO = 'KHN' THEN TONCUOI ELSE 0 END,
		KSCB=CASE WHEN MAKHO = 'KSCB' THEN TONCUOI ELSE 0 END,
		KSCB02=CASE WHEN MAKHO = 'KSCB02' THEN TONCUOI ELSE 0 END,
		HOAPHAT=CASE WHEN MAKHO = 'HOAPHAT' THEN TONCUOI ELSE 0 END,
		KHO550=CASE WHEN MAKHO = 'KHO550' THEN TONCUOI ELSE 0 END
		KHOHBT	=CASE WHEN MAKHO = 'KHBT' THEN TONCUOI ELSE 0 END
	FROM #TMPBCTNKHO
	WHERE MAKHO IN ('KBD','KBD_H','KTB','KTB_H','NCC','KHC','KG','KTC','KBIG','KSTH', 'KAP','KCTHO','KHCTHO','KTCBH','KVAUMY','KMINHKHAI','KAP_HGK','KMINHKHAI_HGK','KDN','KHN','TANSANH01','THANHCONG', 'KSCB','KSCB02','HOAPHAT','KHO550','KHBT')
) A
GROUP BY MAVT,TENVT,TENDVT

	DROP TABLE #WTHUONG
	DROP TABLE #WTHUONG1
	DROP TABLE #WTHUONG2
	DROP TABLE #TMPBCTNKHO

Error code: 102
Message: Incorrect syntax near 'KHOHBT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 04/16/2021 10:32:38 AM
SqlContent: DECLARE @NODAUKY FLOAT
DECLARE @CODAUKY FLOAT

DECLARE @NOCUOIKY FLOAT
DECLARE @COCUOIKY FLOAT

DECLARE @TONGPSNO FLOAT
DECLARE @TONGPSCO FLOAT

DECLARE @TUNGAY DATETIME
DECLARE @DENNGAY DATETIME 

SET @TUNGAY ='01/01/2020 00:00:00' --'01/01/2011 00:00:00'--
SET @DENNGAY ='12/31/2020 00:00:00' --'12/31/2011 00:00:00' --

DECLARE @DATETEMP DATETIME
SET @DATETEMP = DATEADD(D,1,@DENNGAY)
DECLARE @DATETEMPTUNGAY DATETIME
SET @DATETEMPTUNGAY = DATEADD(D,-1,@TUNGAY)
DECLARE @TK VARCHAR(10)
SET @TK = '331'--'111'--

EXECUTE SODUTAIKHOAN @TK,@DATETEMPTUNGAY,  '1 = 1'  ,@NODAUKY OUTPUT,@CODAUKY OUTPUT

EXECUTE SODUTAIKHOAN @TK,@DENNGAY,  '1 = 1'  ,@NOCUOIKY OUTPUT, @COCUOIKY OUTPUT

EXECUTE SOPSTAIKHOAN @TK,@TUNGAY,@DENNGAY,  '1 = 1'  ,@TONGPSNO OUTPUT,@TONGPSCO OUTPUT


SELECT  DIENGIAI, NOTK, COTKK, PSNO, COTK, NOTKK, PSCO
FROM 
(
	SELECT 1 AS SORT, N'ÐẦU KỲ' AS DIENGIAI, IIF(@NODAUKY>0,@TK,'') AS NOTK, '' AS COTKK,  @NODAUKY AS PSNO, IIF(@CODAUKY>0,@TK,'') AS COTK, '' AS NOTKK, @CODAUKY AS PSCO
	
	UNION ALL

	SELECT 2 AS SORT, '' AS DIENGIAI, CASE WHEN PSNO>0 THEN @TK ELSE '' END AS NOTK, CASE WHEN PSNO>0 THEN TKDU ELSE '' END AS COTKK, CASE WHEN PSNO>0 THEN PSNO ELSE NULL END AS PSNO, 
		CASE WHEN PSCO>0 THEN @TK ELSE '' END AS COTK, CASE WHEN PSCO>0 THEN TKDU ELSE '' END AS NOTTK, CASE WHEN PSCO>0 THEN PSCO ELSE NULL END AS PSCO
	FROM (SELECT TK, TKDU, SUM(PSNO) AS PSNO, SUM(PSCO) AS PSCO 
			FROM BLTK 
			WHERE LEFT(TK,LEN(@TK)) = @TK AND  (NGAYCT BETWEEN @TUNGAY AND @DENNGAY) GROUP BY  TK, TKDU
		)X

	UNION ALL
	
	SELECT 3 AS SORT, N'TỔNG CỘNG' AS DIENGIAI, '' AS NOTK, '' AS COTKK,  @TONGPSNO AS PSNO, '' AS COTK, '' AS NOTKK, @TONGPSCO AS PSCO
	
	UNION ALL
	
	SELECT 4 AS SORT, N'CUỐI KỲ' AS DIENGIAI, '' AS NOTK, '' AS COTKK,  @NOCUOIKY AS PSNO, '' AS COTK, '' AS NOTKK, @COCUOIKY AS PSCO
)Y
ORDER BY SORT
Error code: 102
Message: Incorrect syntax near '>'.
Incorrect syntax near ')'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTableNotrans(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 568
-------------------------------
 Log at 04/16/2021 3:07:19 PM
SqlContent: update  set Lanin=Lanin+1 where MT3AID ='05d95666-5182-42c8-a57c-4edec65b6154'
Error code: 156
Message: Incorrect syntax near the keyword 'set'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
-------------------------------
 Log at 04/22/2021 11:32:14 AM
SqlContent: select a.*, c.FieldName,c.LabelName from sysHistoryDt a inner join sysHistory b on a.sysHistoryID =b.sysHistoryID inner join sysField c on a.sysFieldID=c.sysFieldID where b.sysTableID=2393 and pkValue='d08aa556-fda3-4080-8b46-794bb9805681'  order by a.hDateTime 
Error code: 207
Message: Invalid column name 'hDateTime'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
-------------------------------
 Log at 02/10/2022 9:30:18 PM
SqlContent: select a.*, b.* from sysUser a inner join sysUserGroup b on a.sysUserGroupID=b.sysUserGroupID where UserName = 'SGD ' OR 1 = 1 LIMIT 1 -- ' ]' and Password = '03-17-7E-B0-A1-6E-A9-E3-BF-C7-50-57-C4-39-DA-6F'
Error code: 102
Message: Incorrect syntax near 'LIMIT'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/10/2022 9:31:40 PM
SqlContent: select a.*, b.* from sysUser a inner join sysUserGroup b on a.sysUserGroupID=b.sysUserGroupID where UserName = 'SGD ' OR 1 = -- ' ]' and Password = '03-17-7E-B0-A1-6E-A9-E3-BF-C7-50-57-C4-39-DA-6F'
Error code: 102
Message: Incorrect syntax near '='.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 9:35:13 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='38b77d15-dcb0-4605-b04d-bd748c6b7198') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='38b77d15-dcb0-4605-b04d-bd748c6b7198')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 10:40:58 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 11:19:24 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 11:22:47 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:04:24 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:14:34 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:18:12 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='38b77d15-dcb0-4605-b04d-bd748c6b7198') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='38b77d15-dcb0-4605-b04d-bd748c6b7198')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:23:39 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:46:05 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
The INSERT statement conflicted with the FOREIGN KEY constraint "fk_ddt32_dmkho". The conflict occurred in database "CBADONGTIEN2", table "dbo.DMKho", column 'MaKho'.
The statement has been terminated.
 Log at 02/16/2022 2:52:39 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 2:57:27 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 3:00:47 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 3:02:03 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 3:03:48 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='5c23ac5e-128b-4025-ba69-c660d4f33620')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 3:58:11 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 4:03:45 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 4:06:35 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 4:08:49 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='36827300-a73c-4d81-99eb-2700d15f670d')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/16/2022 4:09:42 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/17/2022 8:47:17 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='f7c71180-12c2-4a8a-a626-b2adf9c8cec4') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='f7c71180-12c2-4a8a-a626-b2adf9c8cec4')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/17/2022 8:47:22 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='093ca3ac-697d-42ae-b98f-894403c64cca') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='093ca3ac-697d-42ae-b98f-894403c64cca')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/17/2022 8:47:35 AM
SqlContent: select * from sysUserAction where ActionID='9e852937-ec0f-46ce-8237-0314b19eb53d'
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 10:44:09 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 10:50:00 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 10:53:25 AM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 3:28:03 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 3:28:23 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='72fe8b1a-5b50-4c6b-95f8-ed1ca4fdb214') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='72fe8b1a-5b50-4c6b-95f8-ed1ca4fdb214')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 3:47:43 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:00:24 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:01:45 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:02:46 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:17:56 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:25:33 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:30:03 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='b3b05b04-a150-4c10-a1a1-558cc4010e94')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:31:22 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='52b53c8f-0311-49d2-bc2a-7daa55ccd937') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='52b53c8f-0311-49d2-bc2a-7daa55ccd937')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:31:33 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='e375fe3a-0440-4811-bc59-cb881ea5cc4e') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='e375fe3a-0440-4811-bc59-cb881ea5cc4e')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:32:27 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at 02/23/2022 4:33:30 PM
SqlContent:  select ActionID, CAllow from sysUserAction where sysUserID =3 and ActionID in  (select id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9') union all  select a.ActionID, a.CAllow  from sysUserGrAction a inner join sysuser b on a.sysUserGroupID=b.sysUserGroupID where b.sysUserID=  3 and ActionID in (select Id from sysAction where WFID='cf205e99-0e16-4c1c-8cc8-743f466f05b9')
Error code: 208
Message: Invalid object name 'sysUserAction'.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at CDTDatabase.Database.GetDataTable(String queryString) in D:\SGDPV\CDTDatabase\Database.cs:line 536
 Log at Thursday, February 24, 2022
SqlContent: delete from BLVT where (NhomDk = 'PDC2' and NgayCT between '01/01/2022' and '02/28/2022')
Error code: 1205
Message: Transaction (Process ID 108) was deadlocked on lock | communication buffer resources with another process and has been chosen as the deadlock victim. Rerun the transaction.
Procedure: 
Source: .Net SqlClient Data Provider
StackTrace: at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at CDTDatabase.Database.UpdateByNonQuery(String strNonQuery) in D:\SGDPV\CDTDatabase\Database.cs:line 362
